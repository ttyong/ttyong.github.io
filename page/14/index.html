<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>田勇的博客</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="欢迎来到我的博客">
<meta property="og:type" content="website">
<meta property="og:title" content="田勇的博客">
<meta property="og:url" content="http://tianyong.fun/page/14/index.html">
<meta property="og:site_name" content="田勇的博客">
<meta property="og:description" content="欢迎来到我的博客">
<meta property="article:author" content="TTYONG">
<meta name="twitter:card" content="summary">
  
    <link rel="alternative" href="/atom.xml" title="田勇的博客" type="application/atom+xml">
  
  
    <link rel="icon" href="/img/favicon.png">
  
  
      
<link rel="stylesheet" href="//cdn.bootcss.com/animate.css/3.5.0/animate.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  <link rel="stylesheet" href="/font-awesome/css/font-awesome.min.css">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">
  
    
    
  
  
      <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  
  <!-- 加载特效 -->
    <script src="/js/pace.js"></script>
    <link href="/css/pace/pace-theme-flash.css" rel="stylesheet">
  <script>
      var yiliaConfig = {
          rootUrl: '/',
          fancybox: true,
          animate: true,
          isHome: true,
          isPost: false,
          isArchive: false,
          isTag: false,
          isCategory: false,
          open_in_new: false
      }
  </script>
<meta name="generator" content="Hexo 4.2.0"></head></html>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
    <header id="header" class="inner">
        <a href="/" class="profilepic">
            
            <img lazy-src="/img/head.jpg" class="js-avatar">
            
        </a>

        <hgroup>
          <h1 class="header-author"><a href="/" title="Hi Mate">TTYONG</a></h1>
        </hgroup>

        
        <p class="header-subtitle">比你优秀的人都努力，有什么理由不努力！</p>
        
        
        
            <div id="switch-btn" class="switch-btn">
                <div class="icon">
                    <div class="icon-ctn">
                        <div class="icon-wrap icon-house" data-idx="0">
                            <div class="birdhouse"></div>
                            <div class="birdhouse_holes"></div>
                        </div>
                        <div class="icon-wrap icon-ribbon hide" data-idx="1">
                            <div class="ribbon"></div>
                        </div>
                        
                        <div class="icon-wrap icon-link hide" data-idx="2">
                            <div class="loopback_l"></div>
                            <div class="loopback_r"></div>
                        </div>
                        
                        
                        <div class="icon-wrap icon-me hide" data-idx="3">
                            <div class="user"></div>
                            <div class="shoulder"></div>
                        </div>
                        
                    </div>
                    
                </div>
                <div class="tips-box hide">
                    <div class="tips-arrow"></div>
                    <ul class="tips-inner">
                        <li>菜单</li>
                        <li>标签</li>
                        
                        <li>友情链接</li>
                        
                        
                        <li>关于我</li>
                        
                    </ul>
                </div>
            </div>
        

        <div id="switch-area" class="switch-area">
            <div class="switch-wrap">
                <section class="switch-part switch-part1">
                    <nav class="header-menu">
                        <ul>
                        
                            <li><a href="/Home">博客首页</a></li>
                        
                            <li><a href="/works">作品展示</a></li>
                        
                            <li><a href="/about">留言打卡</a></li>
                        
                            <li><a href="/FrontEndGuide">前端导航</a></li>
                        
                        </ul>
                    </nav>
                    <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fl mail" target="_blank" href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&email=PAkNDgsKBQ4MCnxNTRJfU1E" title="mail" rel="external nofollow noopener noreferrer">mail</a>
                            
                                <a class="fl github" target="_blank" href="https://github.com/luuman" title="github" rel="external nofollow noopener noreferrer">github</a>
                            
                                <a class="fl zhihu" target="_blank" href="#" title="zhihu">zhihu</a>
                            
                                <a class="fl weibo" target="_blank" href="#" title="weibo">weibo</a>
                            
                                <a class="fl google" target="_blank" href="#" title="google">google</a>
                            
                                <a class="fl twitter" target="_blank" href="#" title="twitter">twitter</a>
                            
                                <a class="fl linkedin" target="_blank" href="#" title="linkedin">linkedin</a>
                            
                        </ul>
                    </nav>
                </section>
                
                
                <section class="switch-part switch-part2">
                    <div class="widget tagcloud" id="js-tagcloud">
                        <a href="/tags/ALTER/" style="font-size: 10px;">ALTER</a> <a href="/tags/APlayer/" style="font-size: 10px;">APlayer</a> <a href="/tags/CDN/" style="font-size: 10px;">CDN</a> <a href="/tags/CREATE/" style="font-size: 10px;">CREATE</a> <a href="/tags/C%E5%9F%BA%E6%9C%AC%E5%B8%B8%E8%AF%86/" style="font-size: 10px;">C基本常识</a> <a href="/tags/C%E7%8A%AF%E7%9A%84%E9%94%99%E8%AF%AF/" style="font-size: 10px;">C犯的错误</a> <a href="/tags/DROP/" style="font-size: 10px;">DROP</a> <a href="/tags/HDFS/" style="font-size: 20px;">HDFS</a> <a href="/tags/Hadoop/" style="font-size: 16.67px;">Hadoop</a> <a href="/tags/Hbase/" style="font-size: 10px;">Hbase</a> <a href="/tags/Hexo/" style="font-size: 13.33px;">Hexo</a> <a href="/tags/Hive/" style="font-size: 10px;">Hive</a> <a href="/tags/Mapreduce/" style="font-size: 10px;">Mapreduce</a> <a href="/tags/Pig/" style="font-size: 10px;">Pig</a> <a href="/tags/SELECT/" style="font-size: 10px;">SELECT</a> <a href="/tags/SEO/" style="font-size: 13.33px;">SEO</a> <a href="/tags/SQL/" style="font-size: 16.67px;">SQL</a> <a href="/tags/TOC/" style="font-size: 10px;">TOC</a> <a href="/tags/Text/" style="font-size: 10px;">Text</a> <a href="/tags/URL/" style="font-size: 10px;">URL</a> <a href="/tags/beautifulSoup/" style="font-size: 10px;">beautifulSoup</a> <a href="/tags/bs4/" style="font-size: 10px;">bs4</a> <a href="/tags/charles/" style="font-size: 10px;">charles</a> <a href="/tags/charless/" style="font-size: 10px;">charless</a> <a href="/tags/draft/" style="font-size: 10px;">draft</a> <a href="/tags/eclipse/" style="font-size: 10px;">eclipse</a> <a href="/tags/encrypt/" style="font-size: 10px;">encrypt</a> <a href="/tags/hadoop/" style="font-size: 10px;">hadoop</a> <a href="/tags/hadoop%E6%BA%90%E7%A0%81/" style="font-size: 10px;">hadoop源码</a> <a href="/tags/hdfs/" style="font-size: 10px;">hdfs</a> <a href="/tags/hexo/" style="font-size: 20px;">hexo</a> <a href="/tags/hive/" style="font-size: 10px;">hive</a> <a href="/tags/java/" style="font-size: 20px;">java</a> <a href="/tags/mapreduce/" style="font-size: 10px;">mapreduce</a> <a href="/tags/nofollw/" style="font-size: 10px;">nofollw</a> <a href="/tags/pip/" style="font-size: 10px;">pip</a> <a href="/tags/pymongo/" style="font-size: 10px;">pymongo</a> <a href="/tags/python/" style="font-size: 20px;">python</a> <a href="/tags/python%E7%88%AC%E8%99%AB/" style="font-size: 10px;">python爬虫</a> <a href="/tags/request%E5%BA%93/" style="font-size: 10px;">request库</a> <a href="/tags/re%E5%BA%93/" style="font-size: 10px;">re库</a> <a href="/tags/seo/" style="font-size: 16.67px;">seo</a> <a href="/tags/seo%E4%BC%98%E5%8C%96/" style="font-size: 13.33px;">seo优化</a> <a href="/tags/tools/" style="font-size: 10px;">tools</a> <a href="/tags/urllib/" style="font-size: 10px;">urllib</a> <a href="/tags/vmware/" style="font-size: 10px;">vmware</a> <a href="/tags/xpath/" style="font-size: 10px;">xpath</a> <a href="/tags/yarn/" style="font-size: 10px;">yarn</a> <a href="/tags/zookeeper/" style="font-size: 10px;">zookeeper</a> <a href="/tags/%E4%B9%B1%E7%A0%81/" style="font-size: 13.33px;">乱码</a> <a href="/tags/%E4%BA%8C%E5%88%86%E6%9F%A5%E6%89%BE/" style="font-size: 10px;">二分查找</a> <a href="/tags/%E4%BA%8C%E7%BB%B4%E7%A0%81/" style="font-size: 10px;">二维码</a> <a href="/tags/%E4%BC%98%E5%8C%96/" style="font-size: 13.33px;">优化</a> <a href="/tags/%E5%85%B3%E9%94%AE%E8%AF%8D%E4%B8%8E%E6%8F%8F%E8%BF%B0/" style="font-size: 10px;">关键词与描述</a> <a href="/tags/%E5%88%9B%E5%BB%BA%E8%A1%A8/" style="font-size: 10px;">创建表</a> <a href="/tags/%E5%88%A0%E9%99%A4/" style="font-size: 10px;">删除</a> <a href="/tags/%E5%88%A0%E9%99%A4%E8%A1%A8/" style="font-size: 10px;">删除表</a> <a href="/tags/%E5%8A%A0%E5%AF%86/" style="font-size: 10px;">加密</a> <a href="/tags/%E5%8A%A0%E9%80%9F/" style="font-size: 10px;">加速</a> <a href="/tags/%E5%8C%85%E5%AF%BC%E5%85%A5/" style="font-size: 10px;">包导入</a> <a href="/tags/%E5%8D%95%E8%AF%8D/" style="font-size: 10px;">单词</a> <a href="/tags/%E5%8E%8B%E7%BC%A9%E6%96%87%E4%BB%B6/" style="font-size: 10px;">压缩文件</a> <a href="/tags/%E5%91%BD%E4%BB%A4/" style="font-size: 13.33px;">命令</a> <a href="/tags/%E5%91%BD%E4%BB%A4%E8%A1%8C/" style="font-size: 10px;">命令行</a> <a href="/tags/%E5%9B%BE%E7%89%87/" style="font-size: 10px;">图片</a> <a href="/tags/%E5%9C%86%E8%A7%92/" style="font-size: 10px;">圆角</a> <a href="/tags/%E5%A4%96%E9%93%BE/" style="font-size: 10px;">外链</a> <a href="/tags/%E5%A4%A7%E6%95%B0%E6%8D%AE%E8%A1%8C%E4%B8%9A%E9%A1%B9%E7%9B%AE%E9%83%A8%E7%BD%B2%E5%AE%9E%E6%88%98/" style="font-size: 10px;">大数据行业项目部署实战</a> <a href="/tags/%E5%A4%B4%E5%83%8F/" style="font-size: 10px;">头像</a> <a href="/tags/%E5%A5%BD%E5%8F%8B%E6%8E%A8%E8%8D%90/" style="font-size: 10px;">好友推荐</a> <a href="/tags/%E5%AD%97%E6%95%B0/" style="font-size: 10px;">字数</a> <a href="/tags/%E5%AE%9E%E9%AA%8C%E8%AF%BE/" style="font-size: 13.33px;">实验课</a> <a href="/tags/%E5%AF%B9%E9%BD%90/" style="font-size: 10px;">对齐</a> <a href="/tags/%E5%B0%81%E8%A3%85%E6%88%90%E5%B8%A7/" style="font-size: 10px;">封装成帧</a> <a href="/tags/%E5%B4%94%E5%BA%86%E6%89%8D/" style="font-size: 13.33px;">崔庆才</a> <a href="/tags/%E5%B8%B8%E7%94%A8%E7%94%A8%E6%B3%95/" style="font-size: 10px;">常用用法</a> <a href="/tags/%E5%BB%96%E9%9B%AA%E5%B3%B0/" style="font-size: 13.33px;">廖雪峰</a> <a href="/tags/%E5%BC%80%E5%90%AF/" style="font-size: 10px;">开启</a> <a href="/tags/%E5%BC%82%E5%B8%B8/" style="font-size: 13.33px;">异常</a> <a href="/tags/%E5%BC%95%E7%94%A8/" style="font-size: 10px;">引用</a> <a href="/tags/%E5%BC%95%E7%94%A8%E8%87%AA%E5%B7%B1%E6%96%87%E7%AB%A0/" style="font-size: 10px;">引用自己文章</a> <a href="/tags/%E5%BE%AA%E7%8E%AF%E5%86%97%E4%BD%99%E6%A3%80%E6%B5%8BCRC/" style="font-size: 10px;">循环冗余检测CRC</a> <a href="/tags/%E5%BF%AB%E6%8D%B7%E9%94%AE/" style="font-size: 10px;">快捷键</a> <a href="/tags/%E6%89%80%E6%80%9D%E6%89%80%E6%83%B3/" style="font-size: 10px;">所思所想</a> <a href="/tags/%E6%89%93%E8%B5%8F/" style="font-size: 10px;">打赏</a> <a href="/tags/%E6%8E%92%E7%89%88/" style="font-size: 10px;">排版</a> <a href="/tags/%E6%8E%A8%E9%80%81/" style="font-size: 10px;">推送</a> <a href="/tags/%E6%91%98%E5%BD%95/" style="font-size: 10px;">摘录</a> <a href="/tags/%E6%95%B0%E6%8D%AE%E5%AE%9A%E4%B9%89/" style="font-size: 10px;">数据定义</a> <a href="/tags/%E6%95%B0%E6%8D%AE%E6%9B%B4%E6%96%B0/" style="font-size: 10px;">数据更新</a> <a href="/tags/%E6%95%B0%E6%8D%AE%E6%9F%A5%E8%AF%A2/" style="font-size: 10px;">数据查询</a> <a href="/tags/%E6%97%8B%E8%BD%AC/" style="font-size: 10px;">旋转</a> <a href="/tags/%E6%A0%87%E9%A2%98%E4%BC%98%E5%8C%96/" style="font-size: 10px;">标题优化</a> <a href="/tags/%E6%A6%82%E8%BF%B0/" style="font-size: 10px;">概述</a> <a href="/tags/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/" style="font-size: 10px;">正则表达式</a> <a href="/tags/%E6%BF%80%E6%B4%BB/" style="font-size: 10px;">激活</a> <a href="/tags/%E7%81%AB%E8%BD%A6%E8%AE%A2%E7%A5%A8%E7%B3%BB%E7%BB%9F/" style="font-size: 13.33px;">火车订票系统</a> <a href="/tags/%E7%88%AC%E8%99%AB/" style="font-size: 13.33px;">爬虫</a> <a href="/tags/%E7%89%9B%E9%A1%BF%E6%B3%95/" style="font-size: 10px;">牛顿法</a> <a href="/tags/%E7%89%A9%E7%90%86%E5%B1%82/" style="font-size: 10px;">物理层</a> <a href="/tags/%E7%9B%B4%E6%8E%A5%E6%8F%92%E5%85%A5%E6%8E%92%E5%BA%8F/" style="font-size: 10px;">直接插入排序</a> <a href="/tags/%E7%9B%B4%E9%93%BE/" style="font-size: 10px;">直链</a> <a href="/tags/%E7%A0%B4%E8%A7%A3/" style="font-size: 10px;">破解</a> <a href="/tags/%E7%A8%80%E7%96%8F%E5%90%91%E9%87%8F/" style="font-size: 10px;">稀疏向量</a> <a href="/tags/%E7%AC%AC%E4%BA%8C%E7%AB%A0/" style="font-size: 10px;">第二章</a> <a href="/tags/%E7%BA%A6%E6%9D%9F/" style="font-size: 10px;">约束</a> <a href="/tags/%E7%BA%A6%E6%9D%9F%E7%B1%BB%E5%9E%8B/" style="font-size: 10px;">约束类型</a> <a href="/tags/%E7%BA%BF%E6%80%A7%E5%88%86%E7%B1%BB%E5%99%A8/" style="font-size: 10px;">线性分类器</a> <a href="/tags/%E7%BB%93%E6%9E%84/" style="font-size: 10px;">结构</a> <a href="/tags/%E8%8D%89%E7%A8%BF/" style="font-size: 10px;">草稿</a> <a href="/tags/%E8%A7%86%E5%9B%BE/" style="font-size: 10px;">视图</a> <a href="/tags/%E8%A7%A3%E7%A0%81/" style="font-size: 10px;">解码</a> <a href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/" style="font-size: 10px;">计算机网络</a> <a href="/tags/%E8%AF%84%E8%AE%BA/" style="font-size: 10px;">评论</a> <a href="/tags/%E8%AF%AD%E6%B3%95/" style="font-size: 16.67px;">语法</a> <a href="/tags/%E9%80%8F%E6%98%8E%E4%BC%A0%E8%BE%93/" style="font-size: 10px;">透明传输</a> <a href="/tags/%E9%98%85%E8%AF%BB%E6%97%B6%E9%95%BF/" style="font-size: 13.33px;">阅读时长</a> <a href="/tags/%E9%9F%B3%E4%B9%90%E6%92%AD%E6%94%BE/" style="font-size: 10px;">音乐播放</a> <a href="/tags/%E9%A2%84%E6%98%BE%E7%A4%BA/" style="font-size: 10px;">预显示</a>
                    </div>
                </section>
                
                
                
                <section class="switch-part switch-part3">
                    <div id="js-friends">
                    
                      <a target="_blank" class="main-nav-link switch-friends-link" href="http://luuman.github.io/" rel="external nofollow noopener noreferrer">name</a>
                    
                    </div>
                </section>
                

                
                
                <section class="switch-part switch-part4">
                
                    <div id="js-aboutme">纯海迷、爱运动、爱交友、爱旅行、喜欢接触新鲜事物、迎接新的挑战，更爱游离于错综复杂的编码与逻辑中</div>
                </section>
                
            </div>
        </div>
    </header>                
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
      <div class="overlay">
          <div class="slider-trigger"></div>
          <h1 class="header-author js-mobile-header hide"><a href="/" title="Me">TTYONG</a></h1>
      </div>
    <div class="intrude-less">
        <header id="header" class="inner">
            <a href="/" class="profilepic">
                
                    <img lazy-src="/img/head.jpg" class="js-avatar">
                
            </a>
            <hgroup>
              <h1 class="header-author"><a href="/" title="Me">TTYONG</a></h1>
            </hgroup>
            
            <p class="header-subtitle">比你优秀的人都努力，有什么理由不努力！</p>
            
            <nav class="header-menu">
                <ul>
                
                    <li><a href="/Home">博客首页</a></li>
                
                    <li><a href="/works">作品展示</a></li>
                
                    <li><a href="/about">留言打卡</a></li>
                
                    <li><a href="/FrontEndGuide">前端导航</a></li>
                
                <div class="clearfix"></div>
                </ul>
            </nav>
            <nav class="header-nav">
                <div class="social">
                    
                        <a class="mail" target="_blank" href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&email=PAkNDgsKBQ4MCnxNTRJfU1E" title="mail" rel="external nofollow noopener noreferrer">mail</a>
                    
                        <a class="github" target="_blank" href="https://github.com/luuman" title="github" rel="external nofollow noopener noreferrer">github</a>
                    
                        <a class="zhihu" target="_blank" href="#" title="zhihu">zhihu</a>
                    
                        <a class="weibo" target="_blank" href="#" title="weibo">weibo</a>
                    
                        <a class="google" target="_blank" href="#" title="google">google</a>
                    
                        <a class="twitter" target="_blank" href="#" title="twitter">twitter</a>
                    
                        <a class="linkedin" target="_blank" href="#" title="linkedin">linkedin</a>
                    
                </div>
            </nav>
        </header>                
    </div>
</nav>
      <div class="body-wrap">
  
    <article id="post-hadoop理论课-第一章(初识 Hadoop 大数据技术)" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/hadoop%E7%90%86%E8%AE%BA%E8%AF%BE-%E7%AC%AC%E4%B8%80%E7%AB%A0(%E5%88%9D%E8%AF%86%20Hadoop%20%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF).html" class="article-date">
      <time datetime="2020-05-03T07:03:23.000Z" itemprop="datePublished">2020-05-03</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/hadoop%E7%90%86%E8%AE%BA%E8%AF%BE-%E7%AC%AC%E4%B8%80%E7%AB%A0(%E5%88%9D%E8%AF%86%20Hadoop%20%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF).html">hadoop理论课-第一章</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <hr>
<script type="text/javascript" src="/js/src/bai.js"></script>



<h2 id="初识-Hadoop-大数据技术"><a href="#初识-Hadoop-大数据技术" class="headerlink" title="初识 Hadoop 大数据技术"></a>初识 Hadoop 大数据技术</h2><h3 id="大数据技术概述"><a href="#大数据技术概述" class="headerlink" title="大数据技术概述"></a>大数据技术概述</h3><h4 id="大数据产生的背景"><a href="#大数据产生的背景" class="headerlink" title="大数据产生的背景"></a>大数据产生的背景</h4><p><em>计算机诞生; 互联网发展</em>  </p>
<h4 id="大数据的定义"><a href="#大数据的定义" class="headerlink" title="大数据的定义"></a>大数据的定义</h4><p>“大数据”是一个<strong>涵盖多种技术的概念</strong>，简单地说，是指无法在一定时间内用常规软件工具对<br>其内容进行抓取、管理和处理的数据集合。     </p>
<p>IBM 公司将“大数据”理念定义为 4 个 V，即<strong>大量化( Volume）、多样化（ Variety）、快速化（ Velocity）及由此产生的价值（ Value）</strong>。  </p>
<ul>
<li>数据体量大：大数据的数据量从 TB 级别跃升到 PB 级别。</li>
<li>数据类型多：大数据的数据类型包括前文提到的网络日志、视频、图片、地理位置信息等。</li>
<li>处理速度快： 1 秒定律。最后这一点是大数据技术与传统数据挖掘技术的本质区别。</li>
<li>价值密度低：以视频为例，连续不间断监控过程中，可能有用的数据仅仅有一两秒  </li>
</ul>
<h4 id="大数据技术的发展"><a href="#大数据技术的发展" class="headerlink" title="大数据技术的发展"></a>大数据技术的发展</h4><p><em>大数据技术要面对的基本问题，也是最核心的问题，就是海量数据<strong>如何可靠存储和如何高效计算的问题</strong>。</em>  </p>
<h3 id="Google-的“三驾马车”"><a href="#Google-的“三驾马车”" class="headerlink" title="Google 的“三驾马车”"></a>Google 的“三驾马车”</h3><h4 id="GFS-的思想"><a href="#GFS-的思想" class="headerlink" title="GFS 的思想"></a>GFS 的思想</h4><p><em>论文“The Google File System”描述了一个分布式文件系统的设计思路</em></p>
<p><em>从交互实体上划分，分布式文件系统有两个基本组成部分，一个是<strong>客户端（ Client）</strong>，一个是<strong>服务端（ Server）</strong>.</em>  </p>
<p><em>如果客户端把文件上传到服务端，但是服务端的硬盘不够大，怎么办？ 多加硬盘，或多增加主机</em> </p>
<p><em>数据的存储可靠性怎么保证？ 数据冗余存储</em> </p>
<p><em>主机或硬盘如何被管理起来?  管理节点</em></p>
<p><em>GFS 解决这些问题的思路是这样的，增加一个<strong>管理节点</strong>，去管理这些存放数据的主机。存放数据的主机称为<strong>数据节点</strong>。 而上传的文件会按<strong>固定的大小进行分块</strong>。 数据节点上保存的是<strong>数据块</strong>，而非独立的文件。数据块<strong>冗余度默认是 3</strong>。<strong>上传文件时</strong>，客户端先连接管理节点，管理节点生成数据块的信息，包括文件名、文件大小、上传时间、数据块的位置信息等。这些信息称为<strong>文件的元信息</strong>，它会保存在管理节点。客户端获取这些元信息之后，就开始把数据块一个个上传。客户端把数据块先上传到第一个数据节点，然后，在管理节点的管理下，通过水平复制，复制几份数据块到其他节点，最终达到冗余度的要求。<strong>水平复制需要考虑两个要求：可靠性、可用性</strong>.</em></p>
<p><a href="https://imgchr.com/i/YSnxw4" target="_blank" rel="external nofollow noopener noreferrer"><img src="https://s1.ax1x.com/2020/05/03/YSnxw4.md.png" alt="YSnxw4.md.png" border="0"></a><br><a href="https://imgchr.com/i/YSnvmF" target="_blank" rel="external nofollow noopener noreferrer"><img src="https://s1.ax1x.com/2020/05/03/YSnvmF.md.png" alt="YSnvmF.md.png" border="0"></a></p>
<h4 id="MapReduce-的思想"><a href="#MapReduce-的思想" class="headerlink" title="MapReduce 的思想"></a>MapReduce 的思想</h4><p><em>PageRank，即网页排名，又称网页级别</em>  </p>
<p><em>MapReduce 采用“分而治之”的思想，把对大规模数据集的操作，分发给一个主节点管理下的各个子节点共同完成，然后整合各个子节点的中间结果，得到最终的计算结果。简而言之， MapReduce 就是“分散任务，汇总结果”</em> </p>
<h4 id="BigTable的思想"><a href="#BigTable的思想" class="headerlink" title="BigTable的思想"></a>BigTable的思想</h4><hr>
<blockquote>
</blockquote>

      
      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/Hadoop/">Hadoop</a>
    </div>


      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-vmware安装tools" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/vmware%E5%AE%89%E8%A3%85tools.html" class="article-date">
      <time datetime="2020-04-28T02:39:58.000Z" itemprop="datePublished">2020-04-28</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/vmware%E5%AE%89%E8%A3%85tools.html">vmware安装tools</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <hr>
<script type="text/javascript" src="/js/src/bai.js"></script>



<h2 id="安装vmware-tools"><a href="#安装vmware-tools" class="headerlink" title="安装vmware tools"></a>安装vmware tools</h2><h3 id="选择Linux-iso"><a href="#选择Linux-iso" class="headerlink" title="选择Linux.iso"></a>选择Linux.iso</h3><p><em>关闭vmware重新打开，编辑虚拟系统设置-&gt;CD/DVD-&gt;浏览-&gt;选择linux.iso(在vmware的安装路径下，可以复制到虚拟系统镜像文件iso处-&gt;确定)</em></p>
<p><a href="https://imgchr.com/i/J4YiTO" target="_blank" rel="external nofollow noopener noreferrer"><img src="https://s1.ax1x.com/2020/04/28/J4YiTO.md.png" alt="J4YiTO.png" border="0"></a></p>
<h3 id="安装Tools"><a href="#安装Tools" class="headerlink" title="安装Tools"></a>安装Tools</h3><p><em>打开虚拟系统-&gt;桌面-&gt;左侧导航栏的CD/DVD-&gt;复制里面的tools压缩包到桌面-&gt;右键选择extract here-&gt;打开解压后文件-&gt;shift + 右键-&gt;open terminal -&gt; sudo ./vmware-install.pl-&gt;根据提示成功安装</em></p>
<p><a href="https://imgchr.com/i/J4tgPg" target="_blank" rel="external nofollow noopener noreferrer"><img src="https://s1.ax1x.com/2020/04/28/J4tgPg.md.png" alt="J4tgPg.md.png" border="0"></a></p>
<p><a href="https://imgchr.com/i/J4tR2j" target="_blank" rel="external nofollow noopener noreferrer"><img src="https://s1.ax1x.com/2020/04/28/J4tR2j.md.png" alt="J4tR2j.md.png" border="0"></a></p>
<p><a href="https://imgchr.com/i/J4t2GQ" target="_blank" rel="external nofollow noopener noreferrer"><img src="https://s1.ax1x.com/2020/04/28/J4t2GQ.md.png" alt="J4t2GQ.md.png" border="0"></a></p>
<h3 id><a href="#" class="headerlink" title></a></h3><hr>
<blockquote>
<p>随意春芳歇，王孙自可留。</p>
</blockquote>

      
      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/vmware/">vmware</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/tools/" rel="tag">tools</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/vmware/" rel="tag">vmware</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-数值分析-方程组" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/%E6%95%B0%E5%80%BC%E5%88%86%E6%9E%90-%E6%96%B9%E7%A8%8B%E7%BB%84.html" class="article-date">
      <time datetime="2020-04-26T03:13:22.000Z" itemprop="datePublished">2020-04-26</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/%E6%95%B0%E5%80%BC%E5%88%86%E6%9E%90-%E6%96%B9%E7%A8%8B%E7%BB%84.html">数值分析-方程组</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <hr>
<script type="text/javascript" src="/js/src/bai.js"></script>



<h1 id="方程组"><a href="#方程组" class="headerlink" title="方程组"></a>方程组</h1><h2 id="高斯消去法"><a href="#高斯消去法" class="headerlink" title="高斯消去法"></a>高斯消去法</h2><p><em>难于求解或求高精度的解</em></p>
<h3 id="朴素的高斯消去法"><a href="#朴素的高斯消去法" class="headerlink" title="朴素的高斯消去法"></a>朴素的高斯消去法</h3><p><strong>主元</strong>：主对角线上的元素</p>
<h4 id="步骤"><a href="#步骤" class="headerlink" title="步骤"></a>步骤</h4><h5 id="消去步骤"><a href="#消去步骤" class="headerlink" title="消去步骤"></a>消去步骤</h5><h6 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h6><img src="https://s1.ax1x.com/2020/05/02/JjR2DO.png" alt="JjR2DO.png" border="0">

<p><em>没有在aij的位置放零是因为后续不会用到该值，提高效率</em></p>
<p><em>当遇到主元为零是程序会终止</em></p>
<h5 id="回代或向后求解"><a href="#回代或向后求解" class="headerlink" title="回代或向后求解"></a>回代或向后求解</h5><h6 id="代码-1"><a href="#代码-1" class="headerlink" title="代码"></a>代码</h6><p><a href="https://imgchr.com/i/JjfqAg" target="_blank" rel="external nofollow noopener noreferrer"><img src="https://s1.ax1x.com/2020/05/02/JjfqAg.md.png" alt="JjfqAg.md.png" border="0"></a></p>
<h4 id="操作次数"><a href="#操作次数" class="headerlink" title="操作次数"></a>操作次数</h4><p><em>对消去步骤和回代步骤的计算次数进行统计</em></p>
<h5 id="高斯消去法中消去步骤的操作次数"><a href="#高斯消去法中消去步骤的操作次数" class="headerlink" title="高斯消去法中消去步骤的操作次数"></a>高斯消去法中消去步骤的操作次数</h5><p><em>把第一列转化为0，需要(2n+1)(n-1)次计算：</em></p>
<p>（1+n+n)(n-1)</p>
<img src="https://s1.ax1x.com/2020/04/26/JcgErR.png" alt="JcgErR.png" border="0">

<p>n个方程n个未知数的消去计算，可以在2/3n^3+1/2n^2-7/6n次操作后完成</p>
<h6 id="复杂度"><a href="#复杂度" class="headerlink" title="复杂度"></a>复杂度</h6><p>O(n^3)</p>
<h5 id="高斯消去法中回代步骤的操作次数"><a href="#高斯消去法中回代步骤的操作次数" class="headerlink" title="高斯消去法中回代步骤的操作次数"></a>高斯消去法中回代步骤的操作次数</h5><p><a href="https://imgchr.com/i/JjfHHS" target="_blank" rel="external nofollow noopener noreferrer"><img src="https://s1.ax1x.com/2020/05/02/JjfHHS.png" alt="JjfHHS.png" border="0"></a></p>
<img src="https://s1.ax1x.com/2020/05/02/JjfqAg.md.png" alt="JjfqAg.md.png" border="0">

<p><em>n个 方 程 n个 未 知 数 的 三 角 形 系 统 的 回 代 过 程 可 以 使 用 n^2次操作完成</em></p>
<p>*<em>当n很大时，消去步骤的低阶可以省略; 换 句 话 说 ， 对 于 “，在 复 杂 度 计 算 中 的 低 阶 项 对 于 算 法 运 行 时 间 的 估 计 没 有 大的 影 响 ，并可以忽略.  *</em></p>
<h5 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h5><p><a href="https://imgchr.com/i/Jj7rPU" target="_blank" rel="external nofollow noopener noreferrer"><img src="https://s1.ax1x.com/2020/05/02/Jj7rPU.png" alt="Jj7rPU.png" border="0"></a></p>
<h2 id="高斯主元素消去法"><a href="#高斯主元素消去法" class="headerlink" title="高斯主元素消去法"></a>高斯主元素消去法</h2><p><em>由高斯消去法知道在消元过程中可能出现的情况主元素为0，这时消去法将无法进行；即使主元素但很小时，用其作除数，会导致其他元素数量级的严重增长和舍入误差的扩散，最后也使得计算解不可靠</em></p>
<h2 id="LU分解"><a href="#LU分解" class="headerlink" title="LU分解"></a>LU分解</h2><h3 id="LU分解过程"><a href="#LU分解过程" class="headerlink" title="LU分解过程"></a>LU分解过程</h3><h3 id="法一"><a href="#法一" class="headerlink" title="法一"></a>法一</h3><p><em>在高斯消去法的基础上把0的位置写上倍数</em></p>
<p><a href="https://imgchr.com/i/JorlBF" target="_blank" rel="external nofollow noopener noreferrer"><img src="https://s1.ax1x.com/2020/04/29/JorlBF.md.png" alt="JorlBF.png" border="0"></a></p>
<h3 id="法二"><a href="#法二" class="headerlink" title="法二"></a>法二</h3><p><code>Amn = Lm1U1n + Lm2U2n + ...+ Umn</code></p>
<p><a href="https://imgchr.com/i/JorhDS" target="_blank" rel="external nofollow noopener noreferrer"><img src="https://s1.ax1x.com/2020/04/29/JorhDS.md.jpg" alt="JorhDS.md.jpg" border="0"></a><br><a href="https://imgchr.com/i/Jorfu8" target="_blank" rel="external nofollow noopener noreferrer"><img src="https://s1.ax1x.com/2020/04/29/Jorfu8.md.jpg" alt="Jorfu8.md.jpg" border="0"></a></p>
<h3 id="使用LU分解回代"><a href="#使用LU分解回代" class="headerlink" title="使用LU分解回代"></a>使用LU分解回代</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Ax &#x3D; b</span><br><span class="line">LUx &#x3D; b</span><br><span class="line">Ly &#x3D; b 法二可以直接最初把b也写上，最后b这一列就是y</span><br><span class="line">Ux &#x3D; y</span><br><span class="line">求出x</span><br></pre></td></tr></table></figure>

<h3 id="复杂度-1"><a href="#复杂度-1" class="headerlink" title="复杂度"></a>复杂度</h3><h2 id="追赶法"><a href="#追赶法" class="headerlink" title="追赶法"></a>追赶法</h2><p><em>在一些实际问题中， 例如解常微分方程边值问题，热传导方程以及船体数学放样中建立三次样条函数等，都会要求解系数矩阵为<strong>对角占优的三对角线方程组</strong>.</em></p>
<h3 id="公式"><a href="#公式" class="headerlink" title="公式"></a>公式</h3><img src="https://s1.ax1x.com/2020/05/06/YAFFk4.jpg" alt="YAFFk4.jpg" border="0">

<h3 id="例题-1"><a href="#例题-1" class="headerlink" title="例题"></a>例题</h3><img src="https://s1.ax1x.com/2020/05/06/YAiQWn.jpg" alt="YAiQWn.jpg" border="0">



<img src="https://s1.ax1x.com/2020/05/06/YAVNGQ.jpg" alt="YAVNGQ.jpg" border="0">



<h2 id="向量与矩阵的范数"><a href="#向量与矩阵的范数" class="headerlink" title="向量与矩阵的范数"></a>向量与矩阵的范数</h2><h3 id="向量范数"><a href="#向量范数" class="headerlink" title="向量范数"></a>向量范数</h3><p><a href="https://imgchr.com/i/YWr0s0" target="_blank" rel="external nofollow noopener noreferrer"><img src="https://s1.ax1x.com/2020/05/18/YWr0s0.png" alt="YWr0s0.png" border="0"></a></p>
<h3 id="矩阵范数"><a href="#矩阵范数" class="headerlink" title="矩阵范数"></a>矩阵范数</h3><h5 id="例题-2"><a href="#例题-2" class="headerlink" title="例题"></a>例题</h5><p><a href="https://imgchr.com/i/YGw0y9" target="_blank" rel="external nofollow noopener noreferrer"><img src="https://s1.ax1x.com/2020/05/11/YGw0y9.md.png" alt="YGw0y9.png" border="0"></a></p>
<p><a href="https://imgchr.com/i/YG0CkV" target="_blank" rel="external nofollow noopener noreferrer"><img src="https://s1.ax1x.com/2020/05/11/YG0CkV.md.jpg" alt="YG0CkV.md.jpg" border="0"></a><br><a href="https://imgchr.com/i/YGwOSg" target="_blank" rel="external nofollow noopener noreferrer"><img src="https://s1.ax1x.com/2020/05/11/YGwOSg.md.jpg" alt="YGwOSg.md.jpg" border="0"></a><br><a href="https://imgchr.com/i/YGwbY8" target="_blank" rel="external nofollow noopener noreferrer"><img src="https://s1.ax1x.com/2020/05/11/YGwbY8.jpg" alt="YGwbY8.jpg" border="0"></a></p>
<h3 id="条件数"><a href="#条件数" class="headerlink" title="条件数."></a>条件数.</h3><p><em>与矩阵的范数有关</em></p>
<img src="https://s1.ax1x.com/2020/05/11/YGsegO.md.jpg" alt="YGsegO.jpg" border="0">



<h2 id="线性方程组的迭代方法"><a href="#线性方程组的迭代方法" class="headerlink" title="线性方程组的迭代方法"></a>线性方程组的迭代方法</h2><h3 id="雅可比迭代法-Jacobi"><a href="#雅可比迭代法-Jacobi" class="headerlink" title="雅可比迭代法(Jacobi)"></a>雅可比迭代法(Jacobi)</h3><p><em>1.将线性方程组的第i个方程中的第i个变量用其它n-1个变量表示出来，生成迭代方程组</em></p>
<p><em>2.取定初始向量，依次迭代</em></p>
<p>3.</p>
<p><a href="https://imgchr.com/i/YWrfQ1" target="_blank" rel="external nofollow noopener noreferrer"><img src="https://s1.ax1x.com/2020/05/18/YWrfQ1.md.png" alt="YWrfQ1.png" border="0"></a></p>
<h3 id="例题-3"><a href="#例题-3" class="headerlink" title="例题"></a>例题</h3><p><a href="https://imgchr.com/i/YWHe2t" target="_blank" rel="external nofollow noopener noreferrer"><img src="https://s1.ax1x.com/2020/05/18/YWHe2t.md.jpg" alt="YWHe2t.md.jpg" border="0"></a><br><a href="https://imgchr.com/i/YWHZ8I" target="_blank" rel="external nofollow noopener noreferrer"><img src="https://s1.ax1x.com/2020/05/18/YWHZ8I.md.jpg" alt="YWHZ8I.md.jpg" border="0"></a></p>
<h3 id="Jacobi迭代格式矩阵形式"><a href="#Jacobi迭代格式矩阵形式" class="headerlink" title="Jacobi迭代格式矩阵形式"></a>Jacobi迭代格式矩阵形式</h3><p><a href="https://imgchr.com/i/tpx4OO" target="_blank" rel="external nofollow noopener noreferrer"><img src="https://s1.ax1x.com/2020/05/25/tpx4OO.md.jpg" alt="tpx4OO.jpg" border="0"></a></p>
<h3 id="高斯-赛德尔迭代法-Gauss-Seidel"><a href="#高斯-赛德尔迭代法-Gauss-Seidel" class="headerlink" title="高斯-赛德尔迭代法(Gauss-Seidel)"></a>高斯-赛德尔迭代法(Gauss-Seidel)</h3><p><em>对雅克比迭代法的改进，用以求出的新值代替旧值</em></p>
<h4 id="例题-4"><a href="#例题-4" class="headerlink" title="例题"></a>例题</h4><p><a href="https://imgchr.com/i/YWHCDO" target="_blank" rel="external nofollow noopener noreferrer"><img src="https://s1.ax1x.com/2020/05/18/YWHCDO.md.jpg" alt="YWHCDO.jpg" border="0"></a></p>
<h3 id="逐次超松弛迭代法-SOR"><a href="#逐次超松弛迭代法-SOR" class="headerlink" title="逐次超松弛迭代法(SOR)"></a>逐次超松弛迭代法(SOR)</h3><p><em>针对收敛速度慢的情况。逐次超松弛迭代法是高斯-赛德尔的特殊情况</em></p>
<p><a href="https://imgchr.com/i/YoZEgH" target="_blank" rel="external nofollow noopener noreferrer"><img src="https://s1.ax1x.com/2020/05/20/YoZEgH.md.jpg" alt="YoZEgH.jpg" border="0"></a></p>


<h3 id="迭代法的收敛性"><a href="#迭代法的收敛性" class="headerlink" title="迭代法的收敛性"></a>迭代法的收敛性</h3><p><strong>定理3.11(迭代法的基本定理)：</strong> <em>对任意初值x(0)均收敛的充分必要条件是p(B) &lt; 1</em></p>
<p><strong>推论 2</strong>：</p>
<p><em>Jacobi迭代法收敛的充分必要条件是：</em></p>
<p><em>Gauss-Seidel迭代法收敛的充分必要条件是：</em></p>
<p><em>SOR</em></p>
<hr>
<blockquote>
</blockquote>

      
      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/%E6%95%B0%E5%80%BC%E5%88%86%E6%9E%90/">数值分析</a>
    </div>


      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-计算机网络-第四章" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C-%E7%AC%AC%E5%9B%9B%E7%AB%A0.html" class="article-date">
      <time datetime="2020-04-26T01:52:08.000Z" itemprop="datePublished">2020-04-26</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C-%E7%AC%AC%E5%9B%9B%E7%AB%A0.html">计算机网络-第四章</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <hr>
<script type="text/javascript" src="/js/src/bai.js"></script>

<h1 id="网络层"><a href="#网络层" class="headerlink" title="网络层"></a>网络层</h1><p><em>在计算机网络领域，网络层应该向运输层提供怎样的服务（“面向连接”还是“无连接”）曾引起了长期的争论。<br>争论焦点的实质就是：在计算机通信中，可靠交付应当由谁来负责？是网络还是端系统？</em></p>
<h2 id="网络层提供的两种服务"><a href="#网络层提供的两种服务" class="headerlink" title="网络层提供的两种服务"></a>网络层提供的两种服务</h2><h3 id="虚电路服务"><a href="#虚电路服务" class="headerlink" title="虚电路服务"></a>虚电路服务</h3><p><em>让网络负责可靠交付</em></p>
<p><em>使用面向连接的通信方式</em></p>
<p><em>通信之前先建立虚电路 (Virtual Circuit)，以保证双方通信所需的一切网络资源</em></p>
<p><em>H1 发送给 H2 的所有分组都沿着同一条虚电路传送</em></p>
<p><strong>分组，存储转发，虚拟连接</strong></p>
<h3 id="数据报服务"><a href="#数据报服务" class="headerlink" title="数据报服务"></a>数据报服务</h3><p><em>网络层向上只提供<strong>简单灵活的、无连接的、尽最大努力交付</strong>的数据报服务</em></p>
<p><em>网络层不提供服务质量的承诺</em></p>
<h4 id="尽最大努力交付"><a href="#尽最大努力交付" class="headerlink" title="尽最大努力交付"></a>尽最大努力交付</h4><p><em>由于传输网络不提供端到端的可靠传输服务，这就使网络中的路由器可以做得比较简单，而且价格低廉</em></p>
<p><em>如果主机（即端系统）中的进程之间的<strong>通信需要是可靠的，那么就由网络的主机中的运输层</strong>负责可靠交付（包括差错处理、流量控制等）</em></p>
<p><em>采用这种设计思路的好处是：网络的造价大大降低，运行方式灵活，能够适应多种应用</em></p>
<p><em>H1 发送给 H2</em>的<strong>分组可能沿着不同路径传送</strong></p>
<h3 id="虚电路服务与数据报服务的对比"><a href="#虚电路服务与数据报服务的对比" class="headerlink" title="虚电路服务与数据报服务的对比"></a>虚电路服务与数据报服务的对比</h3><p><a href="https://imgchr.com/i/JRyK1g" target="_blank" rel="external nofollow noopener noreferrer"><img src="https://s1.ax1x.com/2020/04/27/JRyK1g.md.png" alt="JRyK1g.png" border="0"></a></p>
<h2 id="网际协议-IP"><a href="#网际协议-IP" class="headerlink" title="网际协议 IP"></a>网际协议 IP</h2><p><em>网际协议 IP 是 TCP/IP 体系中两个最主要的协议之一</em></p>
<p>与 IP 协议配套使用的还有三个协议：</p>
<ul>
<li>地址解析协议 ARP<pre><code>(Address Resolution Protocol)</code></pre></li>
<li>网际控制报文协议 ICMP<br>   (Internet Control Message Protocol)</li>
<li>网际组管理协议 IGMP<br>   (Internet Group Management Protocol)</li>
</ul>
<p><a href="https://imgchr.com/i/JR6GKH" target="_blank" rel="external nofollow noopener noreferrer"><img src="https://s1.ax1x.com/2020/04/27/JR6GKH.png" alt="JR6GKH.png" border="0"></a></p>
<h3 id="虚拟互连网络"><a href="#虚拟互连网络" class="headerlink" title="虚拟互连网络"></a>虚拟互连网络</h3><p>将网络互相连接起来要使用一些中间设备。<br>中间设备又称为<strong>中间系统或中继 (relay)系统</strong>。<br>有以下五种不同的中间设备：</p>
<ul>
<li>物理层中继系统：转发器 (repeater)。 </li>
<li>数据链路层中继系统：网桥 或 桥接器 (bridge)。</li>
<li>网络层中继系统：路由器 (router)。</li>
<li>网桥和路由器的混合物：桥路器 (brouter)。</li>
<li>网络层以上的中继系统：网关 (gateway)。</li>
</ul>
<h4 id="网络互连使用路由器"><a href="#网络互连使用路由器" class="headerlink" title="网络互连使用路由器"></a>网络互连使用路由器</h4><p><em>当中继系统是转发器或网桥时，一般并不称之为网络互连，因为这仅仅是把一个网络扩大了，而这仍然是一个网络。<br>网关由于比较复杂，目前使用得较少。<br><strong>网络互连都是指用路由器进行网络互连和路由选择</strong>。<br>由于历史的原因，许多有关 TCP/IP 的文献将网络层使用的路由器称为网关</em></p>
<h4 id="互连网络与虚拟互连网络"><a href="#互连网络与虚拟互连网络" class="headerlink" title="互连网络与虚拟互连网络"></a>互连网络与虚拟互连网络</h4><img src="https://s1.ax1x.com/2020/04/27/JRcqXQ.png" alt="JRcqXQ.png" border="0">

<h4 id="虚拟互连网络的意义"><a href="#虚拟互连网络的意义" class="headerlink" title="虚拟互连网络的意义"></a>虚拟互连网络的意义</h4><p><strong>所谓虚拟互连网络也就是逻辑互连网络，利用 IP 协议就可以使这些性能各异的网络从用户看起来好像是一个统一的网络</strong>。</p>
<p>使用 IP 协议的虚拟互连网络可简称为<strong>IP 网</strong></p>
<p><strong>使用虚拟互连网络的好处是</strong>：当互联网上的主机进行通信时，就好像在一个网络上通信一样，而看不见互连的各具体的网络异构细节</p>
<p>如果在这种覆盖全球的 IP 网的上层使用 TCP 协议，那么就是现在的互联网 (Internet)</p>
<h3 id="分类的-IP-地址"><a href="#分类的-IP-地址" class="headerlink" title="分类的 IP 地址"></a>分类的 IP 地址</h3><h4 id="IP-地址及其表示方法"><a href="#IP-地址及其表示方法" class="headerlink" title="IP 地址及其表示方法"></a>IP 地址及其表示方法</h4><p><em>IP 地址就是给每个连接在互联网上的主机（或路由器）分配一个在全世界范围是<strong>唯一的32 位</strong> 的标识符</em></p>
<p><em>IP 地址现在由<strong>互联网名字和数字分配机构</strong>ICANN (Internet Corporation for Assigned Names and Numbers)进行分配</em></p>
<h4 id="IP-地址的编址方法"><a href="#IP-地址的编址方法" class="headerlink" title="IP 地址的编址方法"></a>IP 地址的编址方法</h4><ul>
<li>分类IP 地址。这是最基本的编址方法，在 1981 年就通过了相应的标准协议。</li>
<li>子网的划分。这是对最基本的编址方法的改进，其标准[RFC 950] 在 1985 年通过。</li>
<li>构成超网。这是比较新的无分类编址方法。1993 年提出后很快就得到推广应用</li>
</ul>
<h5 id="分类-IP-地址"><a href="#分类-IP-地址" class="headerlink" title="分类 IP 地址"></a>分类 IP 地址</h5><p>每一类地址都由两个固定长度的字段组成，其中一个字段是<strong>网络号 net-id</strong>，它标志主机（或路由器）所连接到的网络，而另一个字段则是<strong>主机号 host-id</strong>，它标志该主机（或路由器）</p>
<img src="https://s1.ax1x.com/2020/04/27/JR24Rf.png" alt="JR24Rf.png" border="0">

<p><em>总位数是确定的，而网络号和主机号不是确定长度</em></p>
<p><a href="https://imgchr.com/i/JRo5rV" target="_blank" rel="external nofollow noopener noreferrer"><img src="https://s1.ax1x.com/2020/04/27/JRo5rV.png" alt="JRo5rV.png" border="0"></a></p>
<p><em>主机号有多少位就有2^(n-m)-2个主机，网络号就有2^(32-n)-2个网段</em></p>
<h3 id="习题"><a href="#习题" class="headerlink" title="习题"></a>习题</h3><p><a href="https://imgchr.com/i/JRoxr6" target="_blank" rel="external nofollow noopener noreferrer"><img src="https://s1.ax1x.com/2020/04/27/JRoxr6.png" alt="JRoxr6.png" border="0"></a><br><a href="https://imgchr.com/i/JRovKx" target="_blank" rel="external nofollow noopener noreferrer"><img src="https://s1.ax1x.com/2020/04/27/JRovKx.png" alt="JRovKx.png" border="0"></a><br><a href="https://imgchr.com/i/JRoXx1" target="_blank" rel="external nofollow noopener noreferrer"><img src="https://s1.ax1x.com/2020/04/27/JRoXx1.png" alt="JRoXx1.png" border="0"></a></p>
<h3 id="IP-地址与硬件地址"><a href="#IP-地址与硬件地址" class="headerlink" title="IP 地址与硬件地址"></a>IP 地址与硬件地址</h3><p><em>IP 地址与硬件地址是不同的地址</em></p>
<p>从层次的角度看：</p>
<ul>
<li>硬件地址（或物理地址）是数据链路层和物理层使用的地址</li>
<li>IP 地址是网络层和以上各层使用的地址，是一种逻辑地址（称 IP 地址是逻辑地址是因为 IP 地址是用软件实现的）</li>
</ul>
<p><a href="https://imgchr.com/i/J5Ni9g" target="_blank" rel="external nofollow noopener noreferrer"><img src="https://s1.ax1x.com/2020/04/28/J5Ni9g.md.png" alt="J5Ni9g.png" border="0"></a></p>
<p><strong>对应abce类IP地址的默认子网掩码是把网络号全部写为1，主机号为0</strong></p>
<p><strong>路由器的 IP 地址并不出现在 IP 数据报的首部中</strong></p>
<p><strong>在具体的物理网络的链路层只能看见 MAC 帧而看不见 IP 数据报</strong></p>
<img src="https://s1.ax1x.com/2020/05/17/YRV6xK.png" alt="YRV6xK.png" border="0">

<h3 id="地址解析协议-ARP"><a href="#地址解析协议-ARP" class="headerlink" title="地址解析协议 ARP"></a>地址解析协议 ARP</h3><p><em>已经知道了一个机器（主机或路由器）的IP地址，如何找出其相应的硬件地址？地址解析协议 ARP 就是用来解决这样的问题的</em></p>
<p><strong>ARP 作用：从网络层使用的 IP 地址，解析出在数据链路层使用的硬件地址</strong></p>
<p>ARP IP-&gt;MAC</p>
<p>RARP MAC-&gt;IP</p>
<p>ARP分组请求</p>
<h4 id="ARP-高速缓存的作用"><a href="#ARP-高速缓存的作用" class="headerlink" title="ARP 高速缓存的作用"></a>ARP 高速缓存的作用</h4><p><em>存放最近获得的 IP 地址到 MAC 地址的绑定，以减少 ARP 广播的数量</em></p>
<p>TTL:地址映射有效时间</p>
<p>发送广播：前面全为1，后面全为1</p>
<p>发送ARP为广播传输，响应为1对1</p>
<p><a href="https://imgchr.com/i/J5y8JI" target="_blank" rel="external nofollow noopener noreferrer"><img src="https://s1.ax1x.com/2020/04/28/J5y8JI.md.png" alt="J5y8JI.png" border="0"></a></p>
<p>以太网1500字节  数据1480</p>
<p>生存时间：防止无限传输</p>
<h3 id="IP-数据报的格式"><a href="#IP-数据报的格式" class="headerlink" title="IP 数据报的格式"></a>IP 数据报的格式</h3><p><a href="https://imgchr.com/i/J5HxAI" target="_blank" rel="external nofollow noopener noreferrer"><img src="https://s1.ax1x.com/2020/04/28/J5HxAI.md.png" alt="J5HxAI.png" border="0"></a></p>
<p><em>IP数据报=首部+数据部分</em></p>
<p><em>首部=固定部分+可变部分</em></p>
<p><em>固定部分=20字节，是IP数据报必须有的部分；可选字段长度可变</em></p>
<p><strong>版本</strong>：<em>IP协议版本</em></p>
<p><strong>首部长度</strong>：<em>占四个位，最大15个单位，单位为4个字节；所以首部长度最多60个字节</em></p>
<p><strong>总长度</strong>：<em>16位；单位为字节；数据报最长长度为2^16 - 1=65535字节</em></p>
<p><strong>总长度必须不超过最大传送单元 MTU（我们规定不能超过1500字节）</strong></p>
<p><strong>标识</strong>：<em>同一数据包的切片相同</em></p>
<p><strong>标志</strong>：<em>占3位；目前只有前两位有意义。<br>标志字段的最低位是 <strong>MF</strong> (More Fragment)。MF =1 表示后面“还有分片”。MF =0 表示最后一个分片。<br>标志字段中间的一位是 <strong>DF</strong> (Don’t Fragment) 。只有当 DF = 0 时才允许分片</em></p>
<p><strong>片偏移</strong>：<em>占13 位，指出：较长的分组在分片后<br>某片在原分组中的相对位置。片偏移以 8 个字节为偏移单位</em></p>
<p><strong>生存时间</strong>：<em>生存时间——占8 位，记为 TTL (Time To Live)，<br>指示数据报在网络中可通过的路由器数的最大值</em></p>
<h4 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h4><p><a href="https://imgchr.com/i/J5OPgK" target="_blank" rel="external nofollow noopener noreferrer"><img src="https://s1.ax1x.com/2020/04/28/J5OPgK.md.png" alt="J5OPgK.md.png" border="0"></a><br><a href="https://imgchr.com/i/J5OC36" target="_blank" rel="external nofollow noopener noreferrer"><img src="https://s1.ax1x.com/2020/04/28/J5OC36.md.png" alt="J5OC36.md.png" border="0"></a><br><a href="https://imgchr.com/i/J5O99x" target="_blank" rel="external nofollow noopener noreferrer"><img src="https://s1.ax1x.com/2020/04/28/J5O99x.md.png" alt="J5O99x.md.png" border="0"></a></p>
<h2 id="划分子网和构造超网"><a href="#划分子网和构造超网" class="headerlink" title="划分子网和构造超网"></a>划分子网和构造超网</h2><h3 id="划分子网"><a href="#划分子网" class="headerlink" title="划分子网"></a>划分子网</h3><h3 id="使用子网时分组的转发"><a href="#使用子网时分组的转发" class="headerlink" title="使用子网时分组的转发"></a>使用子网时分组的转发</h3><h3 id="无分类编址-CIDR-考点"><a href="#无分类编址-CIDR-考点" class="headerlink" title="无分类编址 CIDR(考点)"></a>无分类编址 CIDR(考点)</h3><img src="https://s1.ax1x.com/2020/05/11/YGuunJ.png" alt="1" border="0">
<img src="https://s1.ax1x.com/2020/05/11/YGumX4.png" alt="2" border="0">
<img src="https://s1.ax1x.com/2020/05/11/YGuKB9.png" alt="3" border="0">
<img src="https://s1.ax1x.com/2020/05/11/YGuVpT.png" alt="4" border="0">



<h2 id="互联网的路由选择协议"><a href="#互联网的路由选择协议" class="headerlink" title="互联网的路由选择协议"></a>互联网的路由选择协议</h2><h3 id="有关路由选择协议的几个基本概念"><a href="#有关路由选择协议的几个基本概念" class="headerlink" title="有关路由选择协议的几个基本概念"></a>有关路由选择协议的几个基本概念</h3><h3 id="内部网关协议-RIP"><a href="#内部网关协议-RIP" class="headerlink" title="内部网关协议 RIP"></a>内部网关协议 RIP</h3><h4 id="RIP-协议的三个特点"><a href="#RIP-协议的三个特点" class="headerlink" title="RIP 协议的三个特点"></a>RIP 协议的三个特点</h4><p>(1) 仅和相邻路由器交换信息。<br>(2) 交换的信息是当前本路由器所知道的全部信息，即自己的路由表。<br>(3) 按固定的时间间隔交换路由信息，例如，每隔 30 秒。当网络拓扑发生变化时，路由器也及时向相邻路由器通告拓扑变化后的路由信息。</p>
<h3 id="内部网关协议-OSPF"><a href="#内部网关协议-OSPF" class="headerlink" title="内部网关协议 OSPF"></a>内部网关协议 OSPF</h3><h4 id="三个要点"><a href="#三个要点" class="headerlink" title="三个要点"></a>三个要点</h4><ul>
<li>向本自治系统中所有路由器发送信息，这里使用的方法是洪泛法。</li>
<li>发送的信息就是与本路由器相邻的所有路由器的链路状态，但这只是路由器所知道的部分信息。<br>“链路状态”就是说明本路由器都和哪些路由器相邻，以及该链路的“度量”(metric)。 </li>
<li>只有当链路状态发生变化时，路由器才用洪泛法向所有路由器发送此信息。</li>
</ul>
<h3 id="外部网关协议-BGP"><a href="#外部网关协议-BGP" class="headerlink" title="外部网关协议 BGP"></a>外部网关协议 BGP</h3><h3 id="路由器的构成"><a href="#路由器的构成" class="headerlink" title="路由器的构成"></a>路由器的构成</h3><h2 id="IPv6"><a href="#IPv6" class="headerlink" title="IPv6"></a>IPv6</h2><p><em>比IPv4地址数扩大2^96倍</em></p>
<h3 id="IPv6-的地址"><a href="#IPv6-的地址" class="headerlink" title="IPv6 的地址"></a>IPv6 的地址</h3><h4 id="冒号十六进制记法"><a href="#冒号十六进制记法" class="headerlink" title="冒号十六进制记法"></a>冒号十六进制记法</h4><h4 id="零省略"><a href="#零省略" class="headerlink" title="零省略"></a>零省略</h4><h4 id="零压缩"><a href="#零压缩" class="headerlink" title="零压缩"></a>零压缩</h4><p><em>只能零压缩一次</em></p>
<h4 id="习题-1"><a href="#习题-1" class="headerlink" title="习题"></a>习题</h4><p><a href="https://imgchr.com/i/YNGoHP" target="_blank" rel="external nofollow noopener noreferrer"><img src="https://s1.ax1x.com/2020/05/12/YNGoHP.md.png" alt="YNGoHP.md.png" border="0"></a><br><a href="https://imgchr.com/i/YNG7Af" target="_blank" rel="external nofollow noopener noreferrer"><img src="https://s1.ax1x.com/2020/05/12/YNG7Af.md.png" alt="YNG7Af.md.png" border="0"></a></p>
<hr>
<blockquote>
</blockquote>

      
      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/">计算机网络</a>
    </div>


      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-大数据行业部署-网站点击流数据分析" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/%E5%A4%A7%E6%95%B0%E6%8D%AE%E8%A1%8C%E4%B8%9A%E9%83%A8%E7%BD%B2-%E7%BD%91%E7%AB%99%E7%82%B9%E5%87%BB%E6%B5%81%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90.html" class="article-date">
      <time datetime="2020-04-23T01:34:25.000Z" itemprop="datePublished">2020-04-23</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/%E5%A4%A7%E6%95%B0%E6%8D%AE%E8%A1%8C%E4%B8%9A%E9%83%A8%E7%BD%B2-%E7%BD%91%E7%AB%99%E7%82%B9%E5%87%BB%E6%B5%81%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90.html">网站点击流数据分析</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <hr>
<script type="text/javascript" src="/js/src/bai.js"></script>



<h1 id="网站点击流数据分析项目业务背景"><a href="#网站点击流数据分析项目业务背景" class="headerlink" title="网站点击流数据分析项目业务背景"></a>网站点击流数据分析项目业务背景</h1><h2 id="什么是点击流数据"><a href="#什么是点击流数据" class="headerlink" title="什么是点击流数据"></a>什么是点击流数据</h2><h3 id="WEB访问日志"><a href="#WEB访问日志" class="headerlink" title="WEB访问日志"></a>WEB访问日志</h3><p><em>即指用户访问网站时的所有访问、浏览、点击行为数据</em></p>
<h4 id="日志的生成渠道："><a href="#日志的生成渠道：" class="headerlink" title="日志的生成渠道："></a>日志的生成渠道：</h4><ul>
<li><p>是网站的web服务器所记录的web访问日志；</p>
</li>
<li><p>是通过在页面嵌入自定义的js代码来获取用户的所有访问行为（比如鼠标悬停的位置，点击的页面组件等），然后通过ajax请求到后台记录日志；这种方式所能采集的信息最全面；</p>
</li>
<li><p>通过在页面上埋点1像素的图片，将相关页面访问信息请求到后台记录日志；</p>
</li>
</ul>
<h4 id="日志数据内容详述"><a href="#日志数据内容详述" class="headerlink" title="日志数据内容详述"></a>日志数据内容详述</h4><p>在实际操作中，有以下几个方面的数据可以被采集：</p>
<ul>
<li><p><strong>访客的系统属性特征</strong>。比如所采用的操作系统、浏览器、域名和访问速度等。</p>
</li>
<li><p><strong>访问特征</strong>。包括停留时间、点击的URL等。</p>
</li>
<li><p><strong>来源特征</strong>。包括网络内容信息类型、内容分类和来访URL等。</p>
</li>
<li><p><strong>产品特征</strong>。包括所访问的产品编号、产品类别、产品颜色、产品价格、产品利润、产品数量和特价等级等</p>
</li>
</ul>
<h3 id="点击流数据模型"><a href="#点击流数据模型" class="headerlink" title="点击流数据模型"></a>点击流数据模型</h3><p><code>点击流这个概念更注重用户浏览网站的整个流程，网站日志中记录的用户点击就像是图上的“点”，而点击流更像是将这些“点”串起来形成的“线”</code></p>
<p><strong>点击流数据是由网站日志中整理得到的</strong></p>
<h4 id="点击流模型生成"><a href="#点击流模型生成" class="headerlink" title="点击流模型生成"></a>点击流模型生成</h4><p><em>点击流数据在具体操作上是由散点状的点击日志数据梳理所得，从而，点击数据在数据建模时应该存在两张模型表（Pageviews和visits)</em></p>
<img src="https://s1.ax1x.com/2020/04/23/JaZcUU.png" alt="JaZcUU.png" border="0">

<p><em>这就是点击流模型。当WEB日志转化成点击流数据的时候，很多网站分析度量的计算变得简单了，这就是点击流的“魔力”所在。基于点击流数据我们可以统计出许多常见的网站分析度量</em></p>
<h2 id="网站流量数据分析的意义"><a href="#网站流量数据分析的意义" class="headerlink" title="网站流量数据分析的意义"></a>网站流量数据分析的意义</h2><p><em>网站流量统计分析，可以帮助网站管理员、运营人员、推广人员等实时获取网站流量信息，并从流量来源、网站内容、网站访客特性等多方面提供网站分析的数据依据。从而<strong>帮助提高网站流量，提升网站用户体验，让访客更多的沉淀下来变成会员或客户，通过更少的投入获取最大化的收入</strong>.</em></p>
<p><strong>终极目标是：改善网站(电商、社交、电影、小说)的运营，获取更高投资回报率（ROI）</strong></p>
<h3 id="技术上"><a href="#技术上" class="headerlink" title="技术上"></a>技术上</h3><ul>
<li><p>辅助改进网络的拓扑设计，提高性能</p>
</li>
<li><p>在有高度相关性的节点之间安排快速有效的访问路径</p>
</li>
<li><p>帮助企业更好地设计网站主页和安排网页内容</p>
</li>
</ul>
<h3 id="业务上"><a href="#业务上" class="headerlink" title="业务上"></a>业务上</h3><ul>
<li><p>帮助企业改善市场营销决策，如把广告放在适当的Web页面上。</p>
</li>
<li><p>优化页面及业务流程设计，提高流量转化率。</p>
</li>
<li><p>帮助企业更好地根据客户的兴趣来安排内容。</p>
</li>
<li><p>帮助企业对客户群进行细分，针对不同客户制定个性化的促销策略等</p>
</li>
</ul>
<h2 id="如何进行网站流量分析"><a href="#如何进行网站流量分析" class="headerlink" title="如何进行网站流量分析"></a>如何进行网站流量分析</h2><p><em>流量分析整体来说是一个内涵非常丰富的体系，其整体过程是一个金字塔结构</em></p>
<h3 id="流量分析模型举例"><a href="#流量分析模型举例" class="headerlink" title="流量分析模型举例"></a>流量分析模型举例</h3><h4 id="网站流量质量分析"><a href="#网站流量质量分析" class="headerlink" title="网站流量质量分析"></a>网站流量质量分析</h4><p><em>流量并不是越多越好，应该更加看重流量的质量，换句话来说就是流量可以为我们带来多少收入</em></p>
<img src="https://s1.ax1x.com/2020/04/23/JauesA.png" alt="JauesA.png" border="0">

<h4 id="网站流量多维度细分"><a href="#网站流量多维度细分" class="headerlink" title="网站流量多维度细分"></a>网站流量多维度细分</h4><p><em>细分是指通过不同维度对指标进行分割，查看同一个指标在不同维度下的表现，进而找出有问题的那部分指标，对这部分指标进行优化</em></p>
<img src="https://s1.ax1x.com/2020/04/23/JauuZt.png" alt="JauuZt.png" border="0">

<h4 id="网站内容及导航分析"><a href="#网站内容及导航分析" class="headerlink" title="网站内容及导航分析"></a>网站内容及导航分析</h4><p><em>对于所有网站来说，页面都可以被划分为三个类别: 导航页，功能页， 内容页</em></p>
<p><em>比如从内容导航分析中，以下两类行为就是网站运营者不希望看到的行为：</em></p>
<img src="https://s1.ax1x.com/2020/04/23/Jauli8.png" alt="Jauli8.png" border="0">

<h4 id="网站转化及漏斗分析"><a href="#网站转化及漏斗分析" class="headerlink" title="网站转化及漏斗分析"></a>网站转化及漏斗分析</h4><p><em>所谓<strong>转化</strong>，即网站业务流程中的一个封闭渠道，引导用户按照流程最终实现业务目标（比如商品成交）；而<strong>漏斗模型</strong>则是指进入渠道的用户在各环节递进过程中逐渐流失的形象描述；</em></p>
<p><a href="https://imgchr.com/i/JaMg56" target="_blank" rel="external nofollow noopener noreferrer"><img src="https://s1.ax1x.com/2020/04/23/JaMg56.png" alt="JaMg56.png" border="0"></a><br><a href="https://imgchr.com/i/JaMcUx" target="_blank" rel="external nofollow noopener noreferrer"><img src="https://s1.ax1x.com/2020/04/23/JaMcUx.png" alt="JaMcUx.png" border="0"></a></p>
<h3 id="流量分析常见指标"><a href="#流量分析常见指标" class="headerlink" title="流量分析常见指标"></a>流量分析常见指标</h3><h4 id="基础分析（PV-IP-UV）"><a href="#基础分析（PV-IP-UV）" class="headerlink" title="基础分析（PV,IP,UV）"></a>基础分析（PV,IP,UV）</h4><p><em>page view: 同一个人一天浏览一个网站的多少网页，重复的只算一条</em></p>
<p><em>unique visitor: 同一天，只记录第一次进入网站的具有独立IP的访问者，重复访问不计</em></p>
<p><em>PR：pageRank，网页的级别技术。用于标识一个网站的流行程度。来源google</em></p>
<p><strong>Ø</strong> <strong><em>\</em>趋势分析**</strong>：根据选定的时段，提供网站流量数据，通过流量趋势变化形态，为您分析网站访客的访问规律、网站发展状况提供参考。</p>
<p><strong>Ø</strong> <strong><em>\</em>对比分析**</strong>：根据选定的两个对比时段，提供网站流量在时间上的纵向对比报表，帮您发现网站发展状况、发展规律、流量变化率等。</p>
<p><strong>Ø</strong> <strong><em>\</em>当前在线**</strong>：提供当前时刻站点上的访客量，以及最近15分钟流量、来源、受访、访客变化情况等，方便用户及时了解当前网站流量状况。</p>
<p><strong>Ø</strong> <strong><em>\</em>访问明细**</strong>：提供最近7日的访客访问记录，可按每个PV或每次访问行为（访客的每次会话）显示，并可按照来源、搜索词等条件进行筛选。 通过访问明细，用户可以详细了解网站流量的累计过程，从而为用户快速找出流量变动原因提供最原始、最准确的依据</p>
<h4 id="来源分析"><a href="#来源分析" class="headerlink" title="来源分析"></a>来源分析</h4><p><strong><em>\</em>来源分类**</strong></p>
<p><strong><em>\</em>搜索引擎**</strong></p>
<p><strong><em>\</em>搜索词**</strong></p>
<p><strong><em>\</em>最近7日的访客搜索记录**</strong></p>
<p><strong><em>\</em>来路域名**</strong></p>
<p><strong><em>\</em>来路页面**</strong></p>
<p><strong><em>\</em>来源升降榜**</strong></p>
<h4 id="受访分析"><a href="#受访分析" class="headerlink" title="受访分析"></a>受访分析</h4><p><strong><em>\</em>受访域名**</strong></p>
<p><strong><em>\</em>受访页面**</strong></p>
<p><strong><em>\</em>受访升降榜**</strong></p>
<p><strong><em>\</em>热点图**</strong></p>
<p><strong><em>\</em>用户视点**</strong></p>
<p><strong><em>\</em>访问轨迹**</strong></p>
<h4 id="访客分析"><a href="#访客分析" class="headerlink" title="访客分析"></a>访客分析</h4><p><strong><em>\</em>地区运营商**</strong></p>
<p><strong><em>\</em>终端详情**</strong></p>
<p><strong><em>\</em>新老访客**</strong></p>
<p><strong><em>\</em>忠诚度**</strong></p>
<p><strong><em>\</em>活跃度**</strong></p>
<h4 id="转化路径分析"><a href="#转化路径分析" class="headerlink" title="转化路径分析"></a>转化路径分析</h4><h5 id="转化定义"><a href="#转化定义" class="headerlink" title="转化定义"></a>转化定义</h5><p><em>访客在您的网站完成了某项您期望的活动，记为一次转化，如注册或下载</em></p>
<h5 id="路径分析"><a href="#路径分析" class="headerlink" title="路径分析"></a>路径分析</h5><p><em>根据设置的特定路线，监测某一流程的完成转化情况，算出每步的转换率和流失率数据，如注册流程，购买流程等</em></p>
<h2 id="整体技术流程及架构"><a href="#整体技术流程及架构" class="headerlink" title="整体技术流程及架构"></a>整体技术流程及架构</h2><h3 id="数据处理流程"><a href="#数据处理流程" class="headerlink" title="数据处理流程"></a>数据处理流程</h3><h4 id="数据采集"><a href="#数据采集" class="headerlink" title="数据采集"></a>数据采集</h4><p><em>将各服务器上生成的点击流日志通过实时或批量的方式汇聚到HDFS文件系统中</em></p>
<p><em>当然，一个综合分析系统，数据源可能不仅包含**</em>*点击流数据*<strong><em>，还有数据库中的</em></strong>*业务数据*<strong><em>（如用户信息、商品信息、订单信息等）及对分析有益的</em></strong>*外部数据****</p>
<h4 id="数据预处理"><a href="#数据预处理" class="headerlink" title="数据预处理"></a>数据预处理</h4><p><em>通过mapreduce程序对采集到的点击流数据进行预处理，比如清洗，格式整理，滤除脏数据等</em></p>
<h4 id="数据入库"><a href="#数据入库" class="headerlink" title="数据入库"></a>数据入库</h4><p><em>将预处理之后的数据导入到HIVE仓库中相应的库和表中</em></p>
<h4 id="数据分析"><a href="#数据分析" class="headerlink" title="数据分析"></a>数据分析</h4><p><em>项目的核心内容，即根据需求开发ETL分析语句，得出各种统计结果</em></p>
<h4 id="数据展现"><a href="#数据展现" class="headerlink" title="数据展现"></a>数据展现</h4><p><em>将分析所得数据进行可视化</em></p>
<h3 id="项目结构"><a href="#项目结构" class="headerlink" title="项目结构"></a>项目结构</h3><h2 id="模块开发"><a href="#模块开发" class="headerlink" title="模块开发"></a>模块开发</h2><h3 id="生成log表"><a href="#生成log表" class="headerlink" title="生成log表"></a>生成log表</h3><h3 id="生成pageview表"><a href="#生成pageview表" class="headerlink" title="生成pageview表"></a>生成pageview表</h3><h4 id="WeblogPreProcess类"><a href="#WeblogPreProcess类" class="headerlink" title="WeblogPreProcess类"></a>WeblogPreProcess类</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.itcast.bigdata.hive.mr.pre;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.HashSet;</span><br><span class="line"><span class="keyword">import</span> java.util.Set;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.conf.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.fs.Path;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.io.LongWritable;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.io.NullWritable;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.io.Text;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapreduce.Job;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapreduce.Mapper;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapreduce.lib.input.FileInputFormat;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapreduce.lib.output.FileOutputFormat;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.itcast.bigdata.hive.mrbean.WebLogBean;</span><br><span class="line"><span class="keyword">import</span> cn.itcast.bigdata.hive.mrbean.WebLogParser;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 处理原始日志，过滤出真实pv请求</span></span><br><span class="line"><span class="comment"> * 转换时间格式</span></span><br><span class="line"><span class="comment"> * 对缺失字段填充默认值</span></span><br><span class="line"><span class="comment"> * 对记录标记valid和invalid</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span></span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WeblogPreProcess</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">WeblogPreProcessMapper</span> <span class="keyword">extends</span> <span class="title">Mapper</span>&lt;<span class="title">LongWritable</span>, <span class="title">Text</span>, <span class="title">Text</span>, <span class="title">NullWritable</span>&gt; </span>&#123;</span><br><span class="line">		<span class="comment">//用来存储网站url分类数据</span></span><br><span class="line">		Set&lt;String&gt; pages = <span class="keyword">new</span> HashSet&lt;String&gt;();</span><br><span class="line">		Text k = <span class="keyword">new</span> Text();</span><br><span class="line">		NullWritable v = NullWritable.get();</span><br><span class="line"></span><br><span class="line">		<span class="comment">/**</span></span><br><span class="line"><span class="comment">		 * 从外部加载网站url分类数据</span></span><br><span class="line"><span class="comment">		 */</span></span><br><span class="line">		<span class="meta">@Override</span></span><br><span class="line">		<span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">setup</span><span class="params">(Context context)</span> <span class="keyword">throws</span> IOException, InterruptedException </span>&#123;</span><br><span class="line">			pages.add(<span class="string">"/about"</span>);</span><br><span class="line">			pages.add(<span class="string">"/black-ip-list/"</span>);</span><br><span class="line">			pages.add(<span class="string">"/cassandra-clustor/"</span>);</span><br><span class="line">			pages.add(<span class="string">"/finance-rhive-repurchase/"</span>);</span><br><span class="line">			pages.add(<span class="string">"/hadoop-family-roadmap/"</span>);</span><br><span class="line">			pages.add(<span class="string">"/hadoop-hive-intro/"</span>);</span><br><span class="line">			pages.add(<span class="string">"/hadoop-zookeeper-intro/"</span>);</span><br><span class="line">			pages.add(<span class="string">"/hadoop-mahout-roadmap/"</span>);</span><br><span class="line">			</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="meta">@Override</span></span><br><span class="line">		<span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">map</span><span class="params">(LongWritable key, Text value, Context context)</span> <span class="keyword">throws</span> IOException, InterruptedException </span>&#123;</span><br><span class="line"></span><br><span class="line">			String line = value.toString();</span><br><span class="line">			WebLogBean webLogBean = WebLogParser.parser(line);</span><br><span class="line">			<span class="comment">// 过滤js/图片/css等静态资源</span></span><br><span class="line">			WebLogParser.filtStaticResource(webLogBean, pages);</span><br><span class="line">			<span class="comment">/* if (!webLogBean.isValid()) return; */</span></span><br><span class="line">			k.set(webLogBean.toString());</span><br><span class="line">			context.write(k, v);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line"></span><br><span class="line">		Configuration conf = <span class="keyword">new</span> Configuration();</span><br><span class="line">		Job job = Job.getInstance(conf);</span><br><span class="line"></span><br><span class="line">		job.setJarByClass(WeblogPreProcess<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line"></span><br><span class="line">		job.setMapperClass(WeblogPreProcessMapper<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line"></span><br><span class="line">		job.setOutputKeyClass(Text<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">		job.setOutputValueClass(NullWritable<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//		 FileInputFormat.setInputPaths(job, new Path(args[0]));</span></span><br><span class="line"><span class="comment">//		 FileOutputFormat.setOutputPath(job, new Path(args[1]));</span></span><br><span class="line">		FileInputFormat.setInputPaths(job, <span class="keyword">new</span> Path(<span class="string">"c:/weblog/input"</span>));</span><br><span class="line">		FileOutputFormat.setOutputPath(job, <span class="keyword">new</span> Path(<span class="string">"c:/weblog/output"</span>));</span><br><span class="line"></span><br><span class="line">		job.setNumReduceTasks(<span class="number">0</span>);</span><br><span class="line">		</span><br><span class="line">		job.waitForCompletion(<span class="keyword">true</span>);</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="WebLogParser类"><a href="#WebLogParser类" class="headerlink" title="WebLogParser类"></a>WebLogParser类</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.itcast.bigdata.hive.mrbean;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.text.ParseException;</span><br><span class="line"><span class="keyword">import</span> java.text.SimpleDateFormat;</span><br><span class="line"><span class="keyword">import</span> java.util.Locale;</span><br><span class="line"><span class="keyword">import</span> java.util.Set;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WebLogParser</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> SimpleDateFormat df1 = <span class="keyword">new</span> SimpleDateFormat(<span class="string">"dd/MMM/yyyy:HH:mm:ss"</span>, Locale.US);</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> SimpleDateFormat df2 = <span class="keyword">new</span> SimpleDateFormat(<span class="string">"yyyy-MM-dd HH:mm:ss"</span>, Locale.US);</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> WebLogBean <span class="title">parser</span><span class="params">(String line)</span> </span>&#123;</span><br><span class="line">		WebLogBean webLogBean = <span class="keyword">new</span> WebLogBean();</span><br><span class="line">		String[] arr = line.split(<span class="string">" "</span>);</span><br><span class="line">		<span class="keyword">if</span> (arr.length &gt; <span class="number">11</span>) &#123;</span><br><span class="line">			webLogBean.setRemote_addr(arr[<span class="number">0</span>]);</span><br><span class="line">			webLogBean.setRemote_user(arr[<span class="number">1</span>]);</span><br><span class="line">			String time_local = formatDate(arr[<span class="number">3</span>].substring(<span class="number">1</span>));</span><br><span class="line">			<span class="keyword">if</span>(<span class="keyword">null</span>==time_local) time_local=<span class="string">"-invalid_time-"</span>;</span><br><span class="line">			webLogBean.setTime_local(time_local);</span><br><span class="line">			webLogBean.setRequest(arr[<span class="number">6</span>]);</span><br><span class="line">			webLogBean.setStatus(arr[<span class="number">8</span>]);</span><br><span class="line">			webLogBean.setBody_bytes_sent(arr[<span class="number">9</span>]);</span><br><span class="line">			webLogBean.setHttp_referer(arr[<span class="number">10</span>]);</span><br><span class="line"></span><br><span class="line">			<span class="comment">//如果useragent元素较多，拼接useragent</span></span><br><span class="line">			<span class="keyword">if</span> (arr.length &gt; <span class="number">12</span>) &#123;</span><br><span class="line">				StringBuilder sb = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">				<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">11</span>;i&lt;arr.length;i++)&#123;</span><br><span class="line">					sb.append(arr[i]);</span><br><span class="line">				&#125;</span><br><span class="line">				webLogBean.setHttp_user_agent(sb.toString());</span><br><span class="line">			&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">				webLogBean.setHttp_user_agent(arr[<span class="number">11</span>]);</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span> (Integer.parseInt(webLogBean.getStatus()) &gt;= <span class="number">400</span>) &#123;<span class="comment">// 大于400，HTTP错误</span></span><br><span class="line">				webLogBean.setValid(<span class="keyword">false</span>);</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">			<span class="keyword">if</span>(<span class="string">"-invalid_time-"</span>.equals(webLogBean.getTime_local()))&#123;</span><br><span class="line">				webLogBean.setValid(<span class="keyword">false</span>);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			webLogBean.setValid(<span class="keyword">false</span>);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> webLogBean;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">filtStaticResource</span><span class="params">(WebLogBean bean, Set&lt;String&gt; pages)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (!pages.contains(bean.getRequest())) &#123;</span><br><span class="line">			bean.setValid(<span class="keyword">false</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">formatDate</span><span class="params">(String time_local)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="keyword">return</span> df2.format(df1.parse(time_local));</span><br><span class="line">		&#125; <span class="keyword">catch</span> (ParseException e) &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="WebLogBean类"><a href="#WebLogBean类" class="headerlink" title="WebLogBean类"></a>WebLogBean类</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.itcast.bigdata.hive.mrbean;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.DataInput;</span><br><span class="line"><span class="keyword">import</span> java.io.DataOutput;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.text.ParseException;</span><br><span class="line"><span class="keyword">import</span> java.text.SimpleDateFormat;</span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"><span class="keyword">import</span> java.util.Locale;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.io.Writable;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.io.WritableComparable;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 对接外部数据的层，表结构定义最好跟外部数据源保持一致</span></span><br><span class="line"><span class="comment"> * 术语： 贴源表</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span></span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WebLogBean</span> <span class="keyword">implements</span> <span class="title">Writable</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">boolean</span> valid = <span class="keyword">true</span>;<span class="comment">// 判断数据是否合法</span></span><br><span class="line">	<span class="keyword">private</span> String remote_addr;<span class="comment">// 记录客户端的ip地址</span></span><br><span class="line">	<span class="keyword">private</span> String remote_user;<span class="comment">// 记录客户端用户名称,忽略属性"-"</span></span><br><span class="line">	<span class="keyword">private</span> String time_local;<span class="comment">// 记录访问时间与时区</span></span><br><span class="line">	<span class="keyword">private</span> String request;<span class="comment">// 记录请求的url与http协议</span></span><br><span class="line">	<span class="keyword">private</span> String status;<span class="comment">// 记录请求状态；成功是200</span></span><br><span class="line">	<span class="keyword">private</span> String body_bytes_sent;<span class="comment">// 记录发送给客户端文件主体内容大小</span></span><br><span class="line">	<span class="keyword">private</span> String http_referer;<span class="comment">// 用来记录从那个页面链接访问过来的</span></span><br><span class="line">	<span class="keyword">private</span> String http_user_agent;<span class="comment">// 记录客户浏览器的相关信息</span></span><br><span class="line"></span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">set</span><span class="params">(<span class="keyword">boolean</span> valid,String remote_addr, String remote_user, String time_local, String request, String status, String body_bytes_sent, String http_referer, String http_user_agent)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.valid = valid;</span><br><span class="line">		<span class="keyword">this</span>.remote_addr = remote_addr;</span><br><span class="line">		<span class="keyword">this</span>.remote_user = remote_user;</span><br><span class="line">		<span class="keyword">this</span>.time_local = time_local;</span><br><span class="line">		<span class="keyword">this</span>.request = request;</span><br><span class="line">		<span class="keyword">this</span>.status = status;</span><br><span class="line">		<span class="keyword">this</span>.body_bytes_sent = body_bytes_sent;</span><br><span class="line">		<span class="keyword">this</span>.http_referer = http_referer;</span><br><span class="line">		<span class="keyword">this</span>.http_user_agent = http_user_agent;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getRemote_addr</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> remote_addr;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setRemote_addr</span><span class="params">(String remote_addr)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.remote_addr = remote_addr;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getRemote_user</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> remote_user;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setRemote_user</span><span class="params">(String remote_user)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.remote_user = remote_user;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getTime_local</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">this</span>.time_local;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setTime_local</span><span class="params">(String time_local)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.time_local = time_local;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getRequest</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> request;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setRequest</span><span class="params">(String request)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.request = request;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getStatus</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> status;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setStatus</span><span class="params">(String status)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.status = status;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getBody_bytes_sent</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> body_bytes_sent;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setBody_bytes_sent</span><span class="params">(String body_bytes_sent)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.body_bytes_sent = body_bytes_sent;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getHttp_referer</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> http_referer;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setHttp_referer</span><span class="params">(String http_referer)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.http_referer = http_referer;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getHttp_user_agent</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> http_user_agent;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setHttp_user_agent</span><span class="params">(String http_user_agent)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.http_user_agent = http_user_agent;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isValid</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> valid;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setValid</span><span class="params">(<span class="keyword">boolean</span> valid)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.valid = valid;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		StringBuilder sb = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">		sb.append(<span class="keyword">this</span>.valid);</span><br><span class="line">		sb.append(<span class="string">"\001"</span>).append(<span class="keyword">this</span>.getRemote_addr());</span><br><span class="line">		sb.append(<span class="string">"\001"</span>).append(<span class="keyword">this</span>.getRemote_user());</span><br><span class="line">		sb.append(<span class="string">"\001"</span>).append(<span class="keyword">this</span>.getTime_local());</span><br><span class="line">		sb.append(<span class="string">"\001"</span>).append(<span class="keyword">this</span>.getRequest());</span><br><span class="line">		sb.append(<span class="string">"\001"</span>).append(<span class="keyword">this</span>.getStatus());</span><br><span class="line">		sb.append(<span class="string">"\001"</span>).append(<span class="keyword">this</span>.getBody_bytes_sent());</span><br><span class="line">		sb.append(<span class="string">"\001"</span>).append(<span class="keyword">this</span>.getHttp_referer());</span><br><span class="line">		sb.append(<span class="string">"\001"</span>).append(<span class="keyword">this</span>.getHttp_user_agent());</span><br><span class="line">		<span class="keyword">return</span> sb.toString();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">readFields</span><span class="params">(DataInput in)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.valid = in.readBoolean();</span><br><span class="line">		<span class="keyword">this</span>.remote_addr = in.readUTF();</span><br><span class="line">		<span class="keyword">this</span>.remote_user = in.readUTF();</span><br><span class="line">		<span class="keyword">this</span>.time_local = in.readUTF();</span><br><span class="line">		<span class="keyword">this</span>.request = in.readUTF();</span><br><span class="line">		<span class="keyword">this</span>.status = in.readUTF();</span><br><span class="line">		<span class="keyword">this</span>.body_bytes_sent = in.readUTF();</span><br><span class="line">		<span class="keyword">this</span>.http_referer = in.readUTF();</span><br><span class="line">		<span class="keyword">this</span>.http_user_agent = in.readUTF();</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">write</span><span class="params">(DataOutput out)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">		out.writeBoolean(<span class="keyword">this</span>.valid);</span><br><span class="line">		out.writeUTF(<span class="keyword">null</span>==remote_addr?<span class="string">""</span>:remote_addr);</span><br><span class="line">		out.writeUTF(<span class="keyword">null</span>==remote_user?<span class="string">""</span>:remote_user);</span><br><span class="line">		out.writeUTF(<span class="keyword">null</span>==time_local?<span class="string">""</span>:time_local);</span><br><span class="line">		out.writeUTF(<span class="keyword">null</span>==request?<span class="string">""</span>:request);</span><br><span class="line">		out.writeUTF(<span class="keyword">null</span>==status?<span class="string">""</span>:status);</span><br><span class="line">		out.writeUTF(<span class="keyword">null</span>==body_bytes_sent?<span class="string">""</span>:body_bytes_sent);</span><br><span class="line">		out.writeUTF(<span class="keyword">null</span>==http_referer?<span class="string">""</span>:http_referer);</span><br><span class="line">		out.writeUTF(<span class="keyword">null</span>==http_user_agent?<span class="string">""</span>:http_user_agent);</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="生成visit表"><a href="#生成visit表" class="headerlink" title="生成visit表"></a>生成visit表</h3><hr>
<blockquote>
<p>世上所有的惊喜和好运，等于你的人品乘以你的努力。</p>
</blockquote>

      
      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE%E8%A1%8C%E4%B8%9A%E9%A1%B9%E7%9B%AE%E9%83%A8%E7%BD%B2%E5%AE%9E%E6%88%98/">大数据行业项目部署实战</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%A4%A7%E6%95%B0%E6%8D%AE%E8%A1%8C%E4%B8%9A%E9%A1%B9%E7%9B%AE%E9%83%A8%E7%BD%B2%E5%AE%9E%E6%88%98/" rel="tag">大数据行业项目部署实战</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-hadoop实验课-hdfs" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/hadoop%E5%AE%9E%E9%AA%8C%E8%AF%BE-hdfs.html" class="article-date">
      <time datetime="2020-04-21T02:03:34.000Z" itemprop="datePublished">2020-04-21</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/hadoop%E5%AE%9E%E9%AA%8C%E8%AF%BE-hdfs.html">hadoop实验课-hdfs</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <hr>
<script type="text/javascript" src="/js/src/bai.js"></script>



<h1 id="HDFS实验"><a href="#HDFS实验" class="headerlink" title="HDFS实验"></a>HDFS实验</h1><h2 id="通过Java-API操作HDFS"><a href="#通过Java-API操作HDFS" class="headerlink" title="通过Java API操作HDFS"></a>通过Java API操作HDFS</h2><h3 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h3><h4 id="导入hdfs的jar包"><a href="#导入hdfs的jar包" class="headerlink" title="导入hdfs的jar包"></a>导入hdfs的jar包</h4><p>1.<em>将/usr/…/share/common下；/usr/…/share/common/lib下；/usr/…/share/hdfs/下的jar包导入到hadoop项目下的lib</em></p>
<p>2.<em>eclipse的项目单击右键build path-&gt;configure..-&gt;libraries-&gt;external jars</em></p>
<h3 id="代码编写"><a href="#代码编写" class="headerlink" title="代码编写"></a>代码编写</h3><h4 id="文件上传"><a href="#文件上传" class="headerlink" title="文件上传"></a>文件上传</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="keyword">package</span> sugon.edu.hadoop.hdfs;</span><br><span class="line"><span class="keyword">import</span> java.net.URI;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.conf.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.fs.FileSystem;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.fs.Path;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">putFile_HDFS</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception</span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">	Configuration conf = <span class="keyword">new</span> Configuration();</span><br><span class="line">	URI uri = <span class="keyword">new</span> URI(<span class="string">"hdfs://192.168.206.129:8020"</span>);</span><br><span class="line">	FileSystem fs = FileSystem.get(uri, conf, <span class="string">"ttyong"</span>);</span><br><span class="line">	Path src = <span class="keyword">new</span> Path(<span class="string">"/home/ttyong/Public/java/wordCount.txt"</span>);</span><br><span class="line">	Path dst = <span class="keyword">new</span> Path(<span class="string">"/mydir/"</span>);</span><br><span class="line">	fs.copyFromLocalFile(src, dst);</span><br><span class="line">	fs.close();</span><br><span class="line">	System.out.println(<span class="string">"upload successfully"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 流拷贝上传</span></span><br><span class="line"><span class="keyword">package</span> sugon.edu.hadoop.hdfs;</span><br><span class="line"><span class="keyword">import</span> java.io.FileInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.OutputStream;</span><br><span class="line"><span class="keyword">import</span> java.net.URI;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.conf.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.fs.FileSystem;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.fs.Path;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.io.IOUtils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">putFile_HDFS_byLiuKaoBei</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception</span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">	Configuration conf = <span class="keyword">new</span> Configuration();</span><br><span class="line">	URI uri = <span class="keyword">new</span> URI(<span class="string">"hdfs://192.168.206.129:8020"</span>);</span><br><span class="line">	FileSystem fs = FileSystem.get(uri, conf, <span class="string">"ttyong"</span>);</span><br><span class="line">	InputStream is = <span class="keyword">new</span> FileInputStream(<span class="string">"/home/ttyong/Public/java/salaryTotal.txt"</span>);</span><br><span class="line">	OutputStream os = fs.create(<span class="keyword">new</span> Path(<span class="string">"/mydir/salaryTotal.txt"</span>));</span><br><span class="line">	IOUtils.copyBytes(is, os, <span class="number">1024</span>);</span><br><span class="line">	is.close();</span><br><span class="line">	os.close();</span><br><span class="line">	fs.close();</span><br><span class="line">	System.out.println(<span class="string">"upload successfully"</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="文件下载"><a href="#文件下载" class="headerlink" title="文件下载"></a>文件下载</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> sugon.edu.hadoop.hdfs;</span><br><span class="line"><span class="keyword">import</span> java.io.FileInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.OutputStream;</span><br><span class="line"><span class="keyword">import</span> java.net.URI;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.conf.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.fs.FileSystem;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.fs.Path;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.io.IOUtils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">getFile_HDFS</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception</span></span><br><span class="line"><span class="function">	</span>&#123;	</span><br><span class="line">		Configuration conf = <span class="keyword">new</span> Configuration();</span><br><span class="line">		URI uri = <span class="keyword">new</span> URI(<span class="string">"hdfs://192.168.206.129:8020"</span>);</span><br><span class="line">		FileSystem fs = FileSystem.get(uri, conf, <span class="string">"ttyong"</span>);</span><br><span class="line">		Path src = <span class="keyword">new</span> Path(<span class="string">"/mydir/salaryTotal.txt"</span>);</span><br><span class="line">		Path dst = <span class="keyword">new</span> Path(<span class="string">"/home/ttyong/Public/java/test4.txt"</span>);</span><br><span class="line">		System.setProperty(<span class="string">"HADOOP_USER_NAME"</span>, <span class="string">"root"</span>);</span><br><span class="line">		fs.copyToLocalFile(src, dst); <span class="comment">//linux</span></span><br><span class="line">		fs.close();</span><br><span class="line">		System.out.println(<span class="string">"upload successfully"</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 流拷贝下载</span></span><br><span class="line"><span class="keyword">package</span> sugon.edu.hadoop.hdfs;</span><br><span class="line"><span class="keyword">import</span> java.io.FileOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.OutputStream;</span><br><span class="line"><span class="keyword">import</span> java.net.URI;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.conf.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.fs.FileSystem;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.fs.Path;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.io.IOUtils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">getFile_HDFS_ByLiukaobei</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception</span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		Configuration conf = <span class="keyword">new</span> Configuration();</span><br><span class="line">		URI uri = <span class="keyword">new</span> URI(<span class="string">"hdfs://192.168.206.129:8020"</span>);</span><br><span class="line">		FileSystem fs = FileSystem.get(uri, conf, <span class="string">"ttyong"</span>);</span><br><span class="line">		InputStream is = fs.open(<span class="keyword">new</span> Path(<span class="string">"/mydir/salaryTotal.txt"</span>));</span><br><span class="line">		OutputStream os = <span class="keyword">new</span> 		       FileOutputStream(<span class="string">"/home/ttyong/Public/java/test5.txt"</span>);</span><br><span class="line">		IOUtils.copyBytes(is, os, <span class="number">1024</span>);</span><br><span class="line">		is.close();</span><br><span class="line">		os.close();</span><br><span class="line">		fs.close();</span><br><span class="line">		System.out.println(<span class="string">"upload successfully"</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="文件创建"><a href="#文件创建" class="headerlink" title="文件创建"></a>文件创建</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> sugon.edu.hadoop.hdfs;</span><br><span class="line"><span class="keyword">import</span> java.net.URI;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.conf.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.fs.FSDataOutputStream;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.fs.FileSystem;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.fs.Path;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CreateFile_HDFS</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		System.setProperty(<span class="string">"HADOOP_USER_NAME"</span>, <span class="string">"root"</span>);</span><br><span class="line">		Configuration conf = <span class="keyword">new</span> Configuration();</span><br><span class="line">		URI uri = <span class="keyword">new</span> URI(<span class="string">"hdfs://192.168.206.129:8020"</span>);</span><br><span class="line">		FileSystem fs = FileSystem.get(uri, conf, <span class="string">"ttyong"</span>);</span><br><span class="line">		Path path = <span class="keyword">new</span> Path(<span class="string">"/mydir/test2.txt"</span>);</span><br><span class="line">		FSDataOutputStream os = fs.create(path);</span><br><span class="line">		os.writeBytes(<span class="string">"hello HDFS"</span>);</span><br><span class="line">		os.close();</span><br><span class="line">		fs.close();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="文件删除"><a href="#文件删除" class="headerlink" title="文件删除"></a>文件删除</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> sugon.edu.hadoop.hdfs;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.net.URI;</span><br><span class="line"><span class="keyword">import</span> java.net.URISyntaxException;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.conf.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.fs.FileSystem;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.fs.Path;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DeleteFile_HDFS</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception</span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">	Configuration conf = <span class="keyword">new</span> Configuration();</span><br><span class="line">	URI uri = <span class="keyword">new</span> URI(<span class="string">"hdfs://192.168.206.129:8020"</span>);</span><br><span class="line">	FileSystem fs = FileSystem.get(uri, conf, <span class="string">"ttyong"</span>);</span><br><span class="line">	Path path = <span class="keyword">new</span> Path(<span class="string">"/mydir/test2.txt"</span>);</span><br><span class="line">	fs.delete(path);</span><br><span class="line">	fs.close();</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="shell命令访问HDFS"><a href="#shell命令访问HDFS" class="headerlink" title="shell命令访问HDFS"></a>shell命令访问HDFS</h2><h3 id="管理命令"><a href="#管理命令" class="headerlink" title="管理命令"></a>管理命令</h3><a href="/hadoop%E5%B8%B8%E7%94%A8HDFS%E7%AE%A1%E7%90%86%E5%91%BD%E4%BB%A4.html" title="第三章 shell命令操作HDFS-常用HDFS管理命令">第三章 shell命令操作HDFS-常用HDFS管理命令</a>

<h3 id="操作命令"><a href="#操作命令" class="headerlink" title="操作命令"></a>操作命令</h3><a href="/hadoop%E5%B8%B8%E7%94%A8HDFS%E6%93%8D%E4%BD%9C%E5%91%BD%E4%BB%A4.html" title="第三章 shell命令操作HDFS-常用HDFS操作命令">第三章 shell命令操作HDFS-常用HDFS操作命令</a>





<hr>
<blockquote>
</blockquote>

      
      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/Hadoop/">Hadoop</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/hdfs/" rel="tag">hdfs</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%AE%9E%E9%AA%8C%E8%AF%BE/" rel="tag">实验课</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-java相关异常" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/java%E7%9B%B8%E5%85%B3%E5%BC%82%E5%B8%B8.html" class="article-date">
      <time datetime="2020-04-21T01:58:30.000Z" itemprop="datePublished">2020-04-21</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/java%E7%9B%B8%E5%85%B3%E5%BC%82%E5%B8%B8.html">java相关异常</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <hr>
<script type="text/javascript" src="/js/src/bai.js"></script>



<h2 id="在eclipse里创建java项目，里面没有src"><a href="#在eclipse里创建java项目，里面没有src" class="headerlink" title="在eclipse里创建java项目，里面没有src"></a>在eclipse里创建java项目，里面没有src</h2><p><em>创建项目时不要选择<strong>use project folder as root for sources and class files</strong>.</em></p>
<p>##</p>
<hr>
<blockquote>
</blockquote>

      
      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/java/">java</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/eclipse/" rel="tag">eclipse</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/java/" rel="tag">java</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-hadoop实验课-mapreduce" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/hadoop%E5%AE%9E%E9%AA%8C%E8%AF%BE-mapreduce.html" class="article-date">
      <time datetime="2020-04-21T01:33:00.000Z" itemprop="datePublished">2020-04-21</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/hadoop%E5%AE%9E%E9%AA%8C%E8%AF%BE-mapreduce.html">hadoop实验课-mapreduce</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <hr>
<script type="text/javascript" src="/js/src/bai.js"></script>



<h2 id="MapReduce实验"><a href="#MapReduce实验" class="headerlink" title="MapReduce实验"></a>MapReduce实验</h2><h3 id="wordcount"><a href="#wordcount" class="headerlink" title="wordcount"></a>wordcount</h3><h4 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h4><h5 id="jar包导入"><a href="#jar包导入" class="headerlink" title="jar包导入"></a>jar包导入</h5><p><em>1.将mapreduce的jar包复制到eclipse的hadoop项目的lib里</em></p>
<p><em>/usr/hadoop/…/share/mapreduce/</em></p>
<p><em>/home/…/hadoop/lib/</em></p>
<p><em>2.打开eclipse，在项目上单击右键，build path -&gt; configure ..-&gt;libraries-&gt;add external jars</em></p>
<h4 id="编写wordcount的map-和reduce-函数"><a href="#编写wordcount的map-和reduce-函数" class="headerlink" title="编写wordcount的map()和reduce()函数"></a>编写wordcount的map()和reduce()函数</h4><h5 id="map"><a href="#map" class="headerlink" title="map()"></a>map()</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> sudo.edu.hadoop.mapreduce.wordCount;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.io.IntWritable;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.io.LongWritable;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.io.Text;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapreduce.Mapper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">wordCountMapper</span> <span class="keyword">extends</span> <span class="title">Mapper</span>&lt;<span class="title">LongWritable</span>, <span class="title">Text</span>, <span class="title">Text</span>, <span class="title">IntWritable</span>&gt;</span>&#123;</span><br><span class="line">    </span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">map</span><span class="params">(LongWritable key, Text value, Context context)</span></span></span><br><span class="line"><span class="function">			<span class="keyword">throws</span> IOException, InterruptedException </span>&#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		String data = value.toString();</span><br><span class="line">		String[] words = data.split(<span class="string">" "</span>);</span><br><span class="line">		<span class="keyword">for</span>(String w: words) &#123;</span><br><span class="line">			context.write(<span class="keyword">new</span> Text(w), <span class="keyword">new</span> IntWritable(<span class="number">1</span>));</span><br><span class="line">		&#125;	</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="reduce"><a href="#reduce" class="headerlink" title="reduce()"></a>reduce()</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> sudo.edu.hadoop.mapreduce.wordCount;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.io.IntWritable;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.io.Text;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapreduce.Reducer;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">wordCountReducer</span> <span class="keyword">extends</span> <span class="title">Reducer</span>&lt;<span class="title">Text</span>, <span class="title">IntWritable</span>, <span class="title">Text</span>, <span class="title">IntWritable</span>&gt;</span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">reduce</span><span class="params">(Text k3, Iterable&lt;IntWritable&gt; v3,</span></span></span><br><span class="line"><span class="function"><span class="params">			Context context)</span> <span class="keyword">throws</span> IOException, InterruptedException </span>&#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		<span class="keyword">int</span> total = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span>(IntWritable v : v3) &#123;</span><br><span class="line">			total += v.get();</span><br><span class="line">		&#125;</span><br><span class="line">		context.write(k3, <span class="keyword">new</span> IntWritable(total));		</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="main"><a href="#main" class="headerlink" title="main()"></a>main()</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> sudo.edu.hadoop.mapreduce.wordCount;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.conf.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.fs.Path;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.io.IntWritable;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.io.Text;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapreduce.Job;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapreduce.lib.input.FileInputFormat;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapreduce.lib.output.FileOutputFormat;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">wordCountMain</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">		<span class="comment">// </span></span><br><span class="line">		Job job = Job.getInstance(<span class="keyword">new</span> Configuration());</span><br><span class="line">		job.setJarByClass(wordCountMain<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">		<span class="comment">//</span></span><br><span class="line">		job.setMapperClass(wordCountMapper<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">		job.setMapOutputKeyClass(Text<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">		job.setMapOutputValueClass(IntWritable<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">		<span class="comment">//</span></span><br><span class="line">		job.setReducerClass(wordCountReducer<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">		job.setOutputKeyClass(Text<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">		job.setOutputValueClass(IntWritable<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">		<span class="comment">//</span></span><br><span class="line">		FileInputFormat.setInputPaths(job, <span class="keyword">new</span> Path(args[<span class="number">0</span>]));</span><br><span class="line">		FileOutputFormat.setOutputPath(job, <span class="keyword">new</span> Path(args[<span class="number">1</span>]));</span><br><span class="line">		job.waitForCompletion(<span class="keyword">true</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h3 id="各部门员工薪水总和"><a href="#各部门员工薪水总和" class="headerlink" title="各部门员工薪水总和"></a>各部门员工薪水总和</h3><h3 id="序列化和反序列化"><a href="#序列化和反序列化" class="headerlink" title="序列化和反序列化"></a>序列化和反序列化</h3><p><em>序列化是一种将内存中Java对象转化为其它可存储文件或可跨越计算机传输数据流的一种技术</em></p>
<h4 id="Employee"><a href="#Employee" class="headerlink" title="Employee"></a>Employee</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> sudo.edu.hadoop.mapreduce.employeeDemo.serializable;</span><br><span class="line"><span class="keyword">import</span> java.io.DataInput;</span><br><span class="line"><span class="keyword">import</span> java.io.DataOutput;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.io.Writable;</span><br><span class="line"><span class="comment">//数据: 7654,MARTIN,SALESMAN,7698,1981/9/28,1250,1400,30</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Employee</span> <span class="keyword">implements</span> <span class="title">Writable</span></span>&#123;</span><br><span class="line">	</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">int</span> empno;</span><br><span class="line"><span class="keyword">private</span> String ename;</span><br><span class="line"><span class="keyword">private</span> String job;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">int</span> mgr;</span><br><span class="line"><span class="keyword">private</span> String hiredate;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">int</span> sal;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">int</span> comm;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">int</span> deptno;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">readFields</span><span class="params">(DataInput input)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line"><span class="comment">// 反序列化</span></span><br><span class="line"><span class="keyword">this</span>.empno = input.readInt();</span><br><span class="line"><span class="keyword">this</span>.ename = input.readUTF();</span><br><span class="line"><span class="keyword">this</span>.job = input.readUTF();</span><br><span class="line"><span class="keyword">this</span>.mgr = input.readInt();</span><br><span class="line"><span class="keyword">this</span>.hiredate = input.readUTF();</span><br><span class="line"><span class="keyword">this</span>.sal = input.readInt();</span><br><span class="line"><span class="keyword">this</span>.comm = input.readInt();</span><br><span class="line"><span class="keyword">this</span>.deptno = input.readInt();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">write</span><span class="params">(DataOutput output)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line"><span class="comment">// 序列化</span></span><br><span class="line">output.writeInt(<span class="keyword">this</span>.empno);</span><br><span class="line">output.writeUTF(<span class="keyword">this</span>.ename);</span><br><span class="line">output.writeUTF(<span class="keyword">this</span>.job);</span><br><span class="line">output.writeInt(<span class="keyword">this</span>.mgr);</span><br><span class="line">output.writeUTF(<span class="keyword">this</span>.hiredate);</span><br><span class="line">output.writeInt(<span class="keyword">this</span>.sal);</span><br><span class="line">output.writeInt(<span class="keyword">this</span>.comm);</span><br><span class="line">output.writeInt(<span class="keyword">this</span>.deptno);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getEmpno</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> empno;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setEmpno</span><span class="params">(<span class="keyword">int</span> empno)</span> </span>&#123;</span><br><span class="line"><span class="keyword">this</span>.empno = empno;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getEname</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> ename;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setEname</span><span class="params">(String ename)</span> </span>&#123;</span><br><span class="line"><span class="keyword">this</span>.ename = ename;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getJob</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> job;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setJob</span><span class="params">(String job)</span> </span>&#123;</span><br><span class="line"><span class="keyword">this</span>.job = job;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getMgr</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> mgr;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setMgr</span><span class="params">(<span class="keyword">int</span> mgr)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">this</span>.mgr = mgr;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getHiredate</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> hiredate;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setHiredate</span><span class="params">(String hiredate)</span> </span>&#123;</span><br><span class="line"><span class="keyword">this</span>.hiredate = hiredate;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getSal</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> sal;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setSal</span><span class="params">(<span class="keyword">int</span> sal)</span> </span>&#123;</span><br><span class="line"><span class="keyword">this</span>.sal = sal;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getComm</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> comm;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setComm</span><span class="params">(<span class="keyword">int</span> comm)</span> </span>&#123;</span><br><span class="line"><span class="keyword">this</span>.comm = comm;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getDeptno</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> deptno;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setDeptno</span><span class="params">(<span class="keyword">int</span> deptno)</span> </span>&#123;</span><br><span class="line"><span class="keyword">this</span>.deptno = deptno;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="Mapper"><a href="#Mapper" class="headerlink" title="Mapper"></a>Mapper</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> sudo.edu.hadoop.mapreduce.employeeDemo.serializable;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.io.IntWritable;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.io.LongWritable;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.io.Text;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapreduce.Mapper;</span><br><span class="line"></span><br><span class="line"><span class="comment">// k1 v1 k2 v2</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">salaryTotalMapper</span> <span class="keyword">extends</span> <span class="title">Mapper</span>&lt;<span class="title">LongWritable</span>, <span class="title">Text</span>, <span class="title">IntWritable</span>, <span class="title">Employee</span>&gt; </span>&#123;</span><br><span class="line">	<span class="comment">//创建员工对象</span></span><br><span class="line">	Employee e = <span class="keyword">new</span> Employee();</span><br><span class="line">	IntWritable k2 = <span class="keyword">new</span> IntWritable();</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">map</span><span class="params">(LongWritable key1, Text value1, Context context)</span> <span class="keyword">throws</span> IOException, InterruptedException </span>&#123;</span><br><span class="line"><span class="comment">//数据： 7654,MARTIN,SALESMAN,7698,1981/9/28,1250,1400,30</span></span><br><span class="line">		String data = value1.toString();</span><br><span class="line"><span class="comment">//分词</span></span><br><span class="line">		String[] words = data.split(<span class="string">","</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//设置员工的属性</span></span><br><span class="line"><span class="comment">//员工号</span></span><br><span class="line">		e.setEmpno(Integer.parseInt(words[<span class="number">0</span>]));</span><br><span class="line"><span class="comment">//姓名</span></span><br><span class="line">		e.setEname(words[<span class="number">1</span>]);</span><br><span class="line"><span class="comment">//职位</span></span><br><span class="line">		e.setJob(words[<span class="number">2</span>]);</span><br><span class="line"><span class="comment">//老板号（注意：可能没有老板号）</span></span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			e.setMgr(Integer.parseInt(words[<span class="number">3</span>]));</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception ex) &#123;</span><br><span class="line"><span class="comment">//没有老板号</span></span><br><span class="line">			e.setMgr(-<span class="number">1</span>);</span><br><span class="line">		&#125;</span><br><span class="line"><span class="comment">//入职日期</span></span><br><span class="line">		e.setHiredate(words[<span class="number">4</span>]);</span><br><span class="line"><span class="comment">//月薪</span></span><br><span class="line">		e.setSal(Integer.parseInt(words[<span class="number">5</span>]));</span><br><span class="line"><span class="comment">//奖金（注意：奖金也可能没有）</span></span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			e.setComm(Integer.parseInt(words[<span class="number">6</span>]));</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception ex) &#123;</span><br><span class="line"><span class="comment">//没有奖金</span></span><br><span class="line">			e.setComm(<span class="number">0</span>);</span><br><span class="line">		&#125;</span><br><span class="line"><span class="comment">//部门号</span></span><br><span class="line">		e.setDeptno(Integer.parseInt(words[<span class="number">7</span>]));</span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line">		k2.set(e.getDeptno());	</span><br><span class="line"><span class="comment">//输出： k2 部门号 v2 员工对象</span></span><br><span class="line">		context.write(k2,e); </span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="Reducer"><a href="#Reducer" class="headerlink" title="Reducer"></a>Reducer</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> sudo.edu.hadoop.mapreduce.employeeDemo.serializable;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.io.IntWritable;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapreduce.Reducer;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">salaryTotalReducer</span> <span class="keyword">extends</span> <span class="title">Reducer</span>&lt;<span class="title">IntWritable</span>, <span class="title">Employee</span>, <span class="title">IntWritable</span>, <span class="title">IntWritable</span>&gt;</span>&#123;</span><br><span class="line">	IntWritable value = <span class="keyword">new</span> IntWritable();</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">reduce</span><span class="params">(IntWritable k3, Iterable&lt;Employee&gt; v3,Context context)</span></span></span><br><span class="line"><span class="function">			<span class="keyword">throws</span> IOException, InterruptedException </span>&#123;</span><br><span class="line">		<span class="comment">//对v3求和，得到该部门的工资总额</span></span><br><span class="line">		<span class="keyword">int</span> total = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span>(Employee v:v3)&#123;</span><br><span class="line">			total += v.getSal();</span><br><span class="line">		&#125;</span><br><span class="line">		value.set(total);</span><br><span class="line">		<span class="comment">//输出：          部门号   总额</span></span><br><span class="line">		context.write(k3, value);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="Main"><a href="#Main" class="headerlink" title="Main"></a>Main</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> sudo.edu.hadoop.mapreduce.employeeDemo.serializable;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.conf.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.fs.Path;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.io.IntWritable;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapreduce.Job;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapreduce.lib.input.FileInputFormat;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapreduce.lib.output.FileOutputFormat;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">salaryTotalMain</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		<span class="comment">//创建一个job</span></span><br><span class="line">		Job job = Job.getInstance(<span class="keyword">new</span> Configuration());</span><br><span class="line">		job.setJarByClass(salaryTotalMain<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">		<span class="comment">//指定job的mapper和输出的类型k2 v2</span></span><br><span class="line">		job.setMapperClass(salaryTotalMapper<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">		job.setMapOutputKeyClass(IntWritable<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">		job.setMapOutputValueClass(Employee<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">		<span class="comment">//指定job的reducer和输出的类型  k4   v4</span></span><br><span class="line">		job.setReducerClass(salaryTotalReducer<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">		job.setOutputKeyClass(IntWritable<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">		job.setOutputValueClass(IntWritable<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">		<span class="comment">//指定job的输入和输出的路径</span></span><br><span class="line">		FileInputFormat.setInputPaths(job, <span class="keyword">new</span> Path(args[<span class="number">0</span>]));</span><br><span class="line">		FileOutputFormat.setOutputPath(job, <span class="keyword">new</span> Path(args[<span class="number">1</span>]));</span><br><span class="line">		<span class="comment">//执行任务</span></span><br><span class="line">		job.waitForCompletion(<span class="keyword">true</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="分区"><a href="#分区" class="headerlink" title="分区"></a>分区</h3><p><em>Mapper 划分数据的过程称作为分区（ Partition），负责实现划分的数据的类称为 Partitioner。</em></p>
<p><em>MapReduce 默认的 Partitioner 是 HashPartitioner</em></p>
<h4 id="partitioner"><a href="#partitioner" class="headerlink" title="partitioner"></a>partitioner</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> sudo.edu.hadoop.mapreduce.employee.partitioner;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.io.IntWritable;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapreduce.Partitioner;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* 建立自己的分区规则：根据员工的部门号进行分区</span></span><br><span class="line"><span class="comment">* 根据 Map 的输出 k2 v2</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">salaryTotalPatitioner</span> <span class="keyword">extends</span> <span class="title">Partitioner</span>&lt;<span class="title">IntWritable</span>, <span class="title">Employee</span>&gt;</span>&#123;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* numPartition 参数：建立多少个分区</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getPartition</span><span class="params">(IntWritable k2, Employee v2, <span class="keyword">int</span> numPartition)</span> </span>&#123;</span><br><span class="line"><span class="comment">// 如何建立分区</span></span><br><span class="line"><span class="keyword">if</span>(v2.getDeptno() == <span class="number">10</span>)&#123;</span><br><span class="line"><span class="comment">//放入 1 号分区中</span></span><br><span class="line"><span class="keyword">return</span> <span class="number">1</span>%numPartition;</span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span>(v2.getDeptno() == <span class="number">20</span>)&#123;</span><br><span class="line"><span class="comment">//放入 2 号分区中</span></span><br><span class="line"><span class="keyword">return</span> <span class="number">2</span>%numPartition;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"><span class="comment">//放入 0 号分区中</span></span><br><span class="line"><span class="keyword">return</span> <span class="number">3</span>%numPartition;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="Employee-1"><a href="#Employee-1" class="headerlink" title="Employee"></a>Employee</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> sudo.edu.hadoop.mapreduce.employee.partitioner;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.DataInput;</span><br><span class="line"><span class="keyword">import</span> java.io.DataOutput;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.io.Writable;</span><br><span class="line"><span class="comment">//数据: 7654,MARTIN,SALESMAN,7698,1981/9/28,1250,1400,30</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Employee</span> <span class="keyword">implements</span> <span class="title">Writable</span></span>&#123;</span><br><span class="line">	</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">int</span> empno;</span><br><span class="line"><span class="keyword">private</span> String ename;</span><br><span class="line"><span class="keyword">private</span> String job;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">int</span> mgr;</span><br><span class="line"><span class="keyword">private</span> String hiredate;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">int</span> sal;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">int</span> comm;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">int</span> deptno;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">readFields</span><span class="params">(DataInput input)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line"><span class="comment">// 反序列化</span></span><br><span class="line"><span class="keyword">this</span>.empno = input.readInt();</span><br><span class="line"><span class="keyword">this</span>.ename = input.readUTF();</span><br><span class="line"><span class="keyword">this</span>.job = input.readUTF();</span><br><span class="line"><span class="keyword">this</span>.mgr = input.readInt();</span><br><span class="line"><span class="keyword">this</span>.hiredate = input.readUTF();</span><br><span class="line"><span class="keyword">this</span>.sal = input.readInt();</span><br><span class="line"><span class="keyword">this</span>.comm = input.readInt();</span><br><span class="line"><span class="keyword">this</span>.deptno = input.readInt();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">write</span><span class="params">(DataOutput output)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line"><span class="comment">// 序列化</span></span><br><span class="line">output.writeInt(<span class="keyword">this</span>.empno);</span><br><span class="line">output.writeUTF(<span class="keyword">this</span>.ename);</span><br><span class="line">output.writeUTF(<span class="keyword">this</span>.job);</span><br><span class="line">output.writeInt(<span class="keyword">this</span>.mgr);</span><br><span class="line">output.writeUTF(<span class="keyword">this</span>.hiredate);</span><br><span class="line">output.writeInt(<span class="keyword">this</span>.sal);</span><br><span class="line">output.writeInt(<span class="keyword">this</span>.comm);</span><br><span class="line">output.writeInt(<span class="keyword">this</span>.deptno);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getEmpno</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> empno;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setEmpno</span><span class="params">(<span class="keyword">int</span> empno)</span> </span>&#123;</span><br><span class="line"><span class="keyword">this</span>.empno = empno;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getEname</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> ename;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setEname</span><span class="params">(String ename)</span> </span>&#123;</span><br><span class="line"><span class="keyword">this</span>.ename = ename;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getJob</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> job;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setJob</span><span class="params">(String job)</span> </span>&#123;</span><br><span class="line"><span class="keyword">this</span>.job = job;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getMgr</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> mgr;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setMgr</span><span class="params">(<span class="keyword">int</span> mgr)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">this</span>.mgr = mgr;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getHiredate</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> hiredate;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setHiredate</span><span class="params">(String hiredate)</span> </span>&#123;</span><br><span class="line"><span class="keyword">this</span>.hiredate = hiredate;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getSal</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> sal;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setSal</span><span class="params">(<span class="keyword">int</span> sal)</span> </span>&#123;</span><br><span class="line"><span class="keyword">this</span>.sal = sal;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getComm</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> comm;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setComm</span><span class="params">(<span class="keyword">int</span> comm)</span> </span>&#123;</span><br><span class="line"><span class="keyword">this</span>.comm = comm;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getDeptno</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> deptno;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setDeptno</span><span class="params">(<span class="keyword">int</span> deptno)</span> </span>&#123;</span><br><span class="line"><span class="keyword">this</span>.deptno = deptno;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="Mapper-1"><a href="#Mapper-1" class="headerlink" title="Mapper"></a>Mapper</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> sudo.edu.hadoop.mapreduce.employee.partitioner;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.io.IntWritable;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.io.LongWritable;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.io.Text;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapreduce.Mapper;</span><br><span class="line"></span><br><span class="line"><span class="comment">// k1 v1 k2 v2</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">salaryTotalMapper</span> <span class="keyword">extends</span> <span class="title">Mapper</span>&lt;<span class="title">LongWritable</span>, <span class="title">Text</span>, <span class="title">IntWritable</span>, <span class="title">Employee</span>&gt; </span>&#123;</span><br><span class="line">	<span class="comment">//创建员工对象</span></span><br><span class="line">	Employee e = <span class="keyword">new</span> Employee();</span><br><span class="line">	IntWritable k2 = <span class="keyword">new</span> IntWritable();</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">map</span><span class="params">(LongWritable key1, Text value1, Context context)</span> <span class="keyword">throws</span> IOException, InterruptedException </span>&#123;</span><br><span class="line"><span class="comment">//数据： 7654,MARTIN,SALESMAN,7698,1981/9/28,1250,1400,30</span></span><br><span class="line">		String data = value1.toString();</span><br><span class="line"><span class="comment">//分词</span></span><br><span class="line">		String[] words = data.split(<span class="string">","</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//设置员工的属性</span></span><br><span class="line"><span class="comment">//员工号</span></span><br><span class="line">		e.setEmpno(Integer.parseInt(words[<span class="number">0</span>]));</span><br><span class="line"><span class="comment">//姓名</span></span><br><span class="line">		e.setEname(words[<span class="number">1</span>]);</span><br><span class="line"><span class="comment">//职位</span></span><br><span class="line">		e.setJob(words[<span class="number">2</span>]);</span><br><span class="line"><span class="comment">//老板号（注意：可能没有老板号）</span></span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			e.setMgr(Integer.parseInt(words[<span class="number">3</span>]));</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception ex) &#123;</span><br><span class="line"><span class="comment">//没有老板号</span></span><br><span class="line">			e.setMgr(-<span class="number">1</span>);</span><br><span class="line">		&#125;</span><br><span class="line"><span class="comment">//入职日期</span></span><br><span class="line">		e.setHiredate(words[<span class="number">4</span>]);</span><br><span class="line"><span class="comment">//月薪</span></span><br><span class="line">		e.setSal(Integer.parseInt(words[<span class="number">5</span>]));</span><br><span class="line"><span class="comment">//奖金（注意：奖金也可能没有）</span></span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			e.setComm(Integer.parseInt(words[<span class="number">6</span>]));</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception ex) &#123;</span><br><span class="line"><span class="comment">//没有奖金</span></span><br><span class="line">			e.setComm(<span class="number">0</span>);</span><br><span class="line">		&#125;</span><br><span class="line"><span class="comment">//部门号</span></span><br><span class="line">		e.setDeptno(Integer.parseInt(words[<span class="number">7</span>]));</span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line">		k2.set(e.getDeptno());	</span><br><span class="line"><span class="comment">//输出： k2 部门号 v2 员工对象</span></span><br><span class="line">		context.write(k2,e); </span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="Reducer-1"><a href="#Reducer-1" class="headerlink" title="Reducer"></a>Reducer</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> sudo.edu.hadoop.mapreduce.employee.partitioner;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.io.IntWritable;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapreduce.Reducer;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">salaryTotalReducer</span> <span class="keyword">extends</span> <span class="title">Reducer</span>&lt;<span class="title">IntWritable</span>, <span class="title">Employee</span>, <span class="title">IntWritable</span>, <span class="title">IntWritable</span>&gt;</span>&#123;</span><br><span class="line">	IntWritable value = <span class="keyword">new</span> IntWritable();</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">reduce</span><span class="params">(IntWritable k3, Iterable&lt;Employee&gt; v3,Context context)</span></span></span><br><span class="line"><span class="function">			<span class="keyword">throws</span> IOException, InterruptedException </span>&#123;</span><br><span class="line">		<span class="comment">//对v3求和，得到该部门的工资总额</span></span><br><span class="line">		<span class="keyword">int</span> total = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span>(Employee v:v3)&#123;</span><br><span class="line">			total += v.getSal();</span><br><span class="line">		&#125;</span><br><span class="line">		value.set(total);</span><br><span class="line">		<span class="comment">//输出：          部门号   总额</span></span><br><span class="line">		context.write(k3, value);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="Main-1"><a href="#Main-1" class="headerlink" title="Main"></a>Main</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> sudo.edu.hadoop.mapreduce.employee.partitioner;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.conf.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.fs.Path;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.io.IntWritable;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapreduce.Job;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapreduce.lib.input.FileInputFormat;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapreduce.lib.output.FileOutputFormat;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">salaryTotalMain</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		<span class="comment">//创建一个job</span></span><br><span class="line">		Job job = Job.getInstance(<span class="keyword">new</span> Configuration());</span><br><span class="line">		job.setJarByClass(salaryTotalMain<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">		<span class="comment">//指定job的mapper和输出的类型k2 v2</span></span><br><span class="line">		job.setMapperClass(salaryTotalMapper<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">		job.setMapOutputKeyClass(IntWritable<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">		job.setMapOutputValueClass(Employee<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">		<span class="comment">// 指定任务的分区规则;指定建立几个分区</span></span><br><span class="line">		job.setPartitionerClass(salaryTotalPatitioner<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">		job.setNumReduceTasks(<span class="number">3</span>);</span><br><span class="line">		<span class="comment">//指定job的reducer和输出的类型  k4   v4</span></span><br><span class="line">		job.setReducerClass(salaryTotalReducer<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">		job.setOutputKeyClass(IntWritable<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">		job.setOutputValueClass(IntWritable<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">		<span class="comment">//指定job的输入和输出的路径</span></span><br><span class="line">		FileInputFormat.setInputPaths(job, <span class="keyword">new</span> Path(args[<span class="number">0</span>]));</span><br><span class="line">		FileOutputFormat.setOutputPath(job, <span class="keyword">new</span> Path(args[<span class="number">1</span>]));</span><br><span class="line">		<span class="comment">//执行任务</span></span><br><span class="line">		job.waitForCompletion(<span class="keyword">true</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="结果"><a href="#结果" class="headerlink" title="结果"></a>结果</h4><p><a href="https://imgchr.com/i/YntMjJ" target="_blank" rel="external nofollow noopener noreferrer"><img src="https://s1.ax1x.com/2020/05/08/YntMjJ.md.png" alt="YntMjJ.md.png" border="0"></a></p>
<p><a href="https://imgchr.com/i/YntKc4" target="_blank" rel="external nofollow noopener noreferrer"><img src="https://s1.ax1x.com/2020/05/08/YntKc4.md.png" alt="YntKc4.md.png" border="0"></a></p>
<h3 id="合并"><a href="#合并" class="headerlink" title="合并"></a>合并</h3><h3 id="排序"><a href="#排序" class="headerlink" title="排序"></a>排序</h3><p><em>又要排序又要序列化直接继承WritableComparable类; 这个接口继承自writable和comparable接口</em></p>
<h4 id="Main-2"><a href="#Main-2" class="headerlink" title="Main"></a>Main</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> sudo.edu.hadoop.mapreduce.employee.sort;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.conf.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.fs.Path;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.io.IntWritable;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.io.NullWritable;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapreduce.Job;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapreduce.lib.input.FileInputFormat;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapreduce.lib.output.FileOutputFormat;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">EmployeeSortMain</span> </span>&#123;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line"><span class="comment">//创建一个 job</span></span><br><span class="line">Job job = Job.getInstance(<span class="keyword">new</span> Configuration());</span><br><span class="line">job.setJarByClass(EmployeeSortMain<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line"><span class="comment">//指定 job 的 mapper 和输出的类型 k2 v2</span></span><br><span class="line">job.setMapperClass(EmployeeSortMapper<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">job.setMapOutputKeyClass(Employee<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">job.setMapOutputValueClass(NullWritable<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line"><span class="comment">//指定 job 的输入和输出的路径</span></span><br><span class="line">FileInputFormat.setInputPaths(job, <span class="keyword">new</span> Path(args[<span class="number">0</span>]));</span><br><span class="line">FileOutputFormat.setOutputPath(job, <span class="keyword">new</span> Path(args[<span class="number">1</span>]));</span><br><span class="line"><span class="comment">//执行任务</span></span><br><span class="line">job.waitForCompletion(<span class="keyword">true</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="Mapper-2"><a href="#Mapper-2" class="headerlink" title="Mapper"></a>Mapper</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> sudo.edu.hadoop.mapreduce.employee.sort;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.io.LongWritable;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.io.NullWritable;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.io.Text;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapreduce.Mapper;</span><br><span class="line"><span class="comment">//7654,MARTIN,SALESMAN,7698,1981/9/28,1250,1400,30</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">EmployeeSortMapper</span> <span class="keyword">extends</span> <span class="title">Mapper</span>&lt;<span class="title">LongWritable</span>, <span class="title">Text</span>, <span class="title">Employee</span>,</span></span><br><span class="line"><span class="class"><span class="title">NullWritable</span>&gt; </span>&#123;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">map</span><span class="params">(LongWritable key1, Text value1, Context context)</span></span></span><br><span class="line"><span class="function">			<span class="keyword">throws</span> IOException, InterruptedException </span>&#123;</span><br><span class="line">		<span class="comment">//数据： 7654,MARTIN,SALESMAN,7698,1981/9/28,1250,1400,30</span></span><br><span class="line">		String data = value1.toString();</span><br><span class="line">		<span class="comment">//分词</span></span><br><span class="line">		String[] words = data.split(<span class="string">","</span>);</span><br><span class="line">		<span class="comment">//创建员工对象</span></span><br><span class="line">		Employee e = <span class="keyword">new</span> Employee();</span><br><span class="line">		<span class="comment">//设置员工的属性</span></span><br><span class="line">		<span class="comment">//员工号</span></span><br><span class="line">		e.setEmpno(Integer.parseInt(words[<span class="number">0</span>]));</span><br><span class="line">		<span class="comment">//姓名</span></span><br><span class="line">		e.setEname(words[<span class="number">1</span>]);</span><br><span class="line">		<span class="comment">//职位</span></span><br><span class="line">		e.setJob(words[<span class="number">2</span>]);</span><br><span class="line">		<span class="comment">//老板号（注意：可能没有老板号）</span></span><br><span class="line">		<span class="keyword">try</span>&#123;</span><br><span class="line">			e.setMgr(Integer.parseInt(words[<span class="number">3</span>]));</span><br><span class="line">		&#125;<span class="keyword">catch</span>(Exception ex)&#123;</span><br><span class="line">			<span class="comment">//没有老板号</span></span><br><span class="line">			e.setMgr(-<span class="number">1</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">//入职日期</span></span><br><span class="line">		e.setHiredate(words[<span class="number">4</span>]);</span><br><span class="line">		<span class="comment">//月薪</span></span><br><span class="line">		e.setSal(Integer.parseInt(words[<span class="number">5</span>]));</span><br><span class="line">		<span class="comment">//奖金（注意：奖金也可能没有）</span></span><br><span class="line">		<span class="keyword">try</span>&#123;</span><br><span class="line">			e.setComm(Integer.parseInt(words[<span class="number">6</span>]));</span><br><span class="line">		&#125;<span class="keyword">catch</span>(Exception ex)&#123;</span><br><span class="line">			<span class="comment">//没有奖金</span></span><br><span class="line">			e.setComm(<span class="number">0</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">//部门号</span></span><br><span class="line">		e.setDeptno(Integer.parseInt(words[<span class="number">7</span>]));</span><br><span class="line">		<span class="comment">//输出</span></span><br><span class="line">		context.write(e, NullWritable.get());</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="Employee-2"><a href="#Employee-2" class="headerlink" title="Employee"></a>Employee</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> sudo.edu.hadoop.mapreduce.employee.sort;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.DataInput;</span><br><span class="line"><span class="keyword">import</span> java.io.DataOutput;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.io.Writable;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.io.WritableComparable;</span><br><span class="line"><span class="comment">//1．若要把 Employee 作为 key2，则需要实现序列化</span></span><br><span class="line"><span class="comment">//2．员工对象为 Employee 类，可被排序</span></span><br><span class="line"><span class="comment">//数据: 7654,MARTIN,SALESMAN,7698,1981/9/28,1250,1400,30</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Employee</span> <span class="keyword">implements</span> <span class="title">WritableComparable</span>&lt;<span class="title">Employee</span>&gt;</span>&#123;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">int</span> empno;</span><br><span class="line"><span class="keyword">private</span> String ename;</span><br><span class="line"><span class="keyword">private</span> String job;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">int</span> mgr;</span><br><span class="line"><span class="keyword">private</span> String hiredate;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">int</span> sal;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">int</span> comm;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">int</span> deptno;</span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="string">"Employee [empno="</span> + empno + <span class="string">", ename="</span> + ename + <span class="string">", sal="</span> + sal + <span class="string">",</span></span><br><span class="line"><span class="string">			deptno="</span> + deptno + <span class="string">"]"</span>;</span><br><span class="line">			&#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">compareTo</span><span class="params">(Employee o)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 多个列的排序： select * from emp order by deptno,sal;</span></span><br><span class="line">        <span class="comment">//首先按照 deptno 排序</span></span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">this</span>.deptno &gt; o.getDeptno())&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="keyword">this</span>.deptno &lt; o.getDeptno())&#123;</span><br><span class="line">            <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//如果 deptno 相等，按照 sal 排序</span></span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">this</span>.sal &gt;= o.getSal())&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">readFields</span><span class="params">(DataInput input)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        <span class="comment">// 反序列化</span></span><br><span class="line">        <span class="keyword">this</span>.empno = input.readInt();</span><br><span class="line">        <span class="keyword">this</span>.ename = input.readUTF();</span><br><span class="line">        <span class="keyword">this</span>.job = input.readUTF();</span><br><span class="line">        <span class="keyword">this</span>.mgr = input.readInt();</span><br><span class="line">        <span class="keyword">this</span>.hiredate = input.readUTF();</span><br><span class="line">        <span class="keyword">this</span>.sal = input.readInt();</span><br><span class="line">        <span class="keyword">this</span>.comm = input.readInt();</span><br><span class="line">        <span class="keyword">this</span>.deptno = input.readInt();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">write</span><span class="params">(DataOutput output)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        <span class="comment">// 序列化</span></span><br><span class="line">        output.writeInt(<span class="keyword">this</span>.empno);</span><br><span class="line">        output.writeUTF(<span class="keyword">this</span>.ename);</span><br><span class="line">        output.writeUTF(<span class="keyword">this</span>.job);</span><br><span class="line">        output.writeInt(<span class="keyword">this</span>.mgr);</span><br><span class="line">        output.writeUTF(<span class="keyword">this</span>.hiredate);</span><br><span class="line">        output.writeInt(<span class="keyword">this</span>.sal);</span><br><span class="line">        output.writeInt(<span class="keyword">this</span>.comm);</span><br><span class="line">        output.writeInt(<span class="keyword">this</span>.deptno);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getEmpno</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> empno;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setEmpno</span><span class="params">(<span class="keyword">int</span> empno)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.empno = empno;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getEname</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ename;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setEname</span><span class="params">(String ename)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.ename = ename;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getJob</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> job;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setJob</span><span class="params">(String job)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.job = job;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getMgr</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> mgr;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setMgr</span><span class="params">(<span class="keyword">int</span> mgr)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.mgr = mgr;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getHiredate</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> hiredate;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setHiredate</span><span class="params">(String hiredate)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.hiredate = hiredate;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getSal</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> sal;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setSal</span><span class="params">(<span class="keyword">int</span> sal)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.sal = sal;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getComm</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> comm;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setComm</span><span class="params">(<span class="keyword">int</span> comm)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.comm = comm;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getDeptno</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> deptno;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setDeptno</span><span class="params">(<span class="keyword">int</span> deptno)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.deptno = deptno;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<hr>
<blockquote>
<p>人穷没入群，言轻莫劝人。</p>
</blockquote>

      
      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/Hadoop/">Hadoop</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/mapreduce/" rel="tag">mapreduce</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%AE%9E%E9%AA%8C%E8%AF%BE/" rel="tag">实验课</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-数值分析-求解方程" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/%E6%95%B0%E5%80%BC%E5%88%86%E6%9E%90-%E6%B1%82%E8%A7%A3%E6%96%B9%E7%A8%8B.html" class="article-date">
      <time datetime="2020-04-20T02:51:34.000Z" itemprop="datePublished">2020-04-20</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/%E6%95%B0%E5%80%BC%E5%88%86%E6%9E%90-%E6%B1%82%E8%A7%A3%E6%96%B9%E7%A8%8B.html">数值分析-牛顿法</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <hr>
<script type="text/javascript" src="/js/src/bai.js"></script>



<h2 id="二分法"><a href="#二分法" class="headerlink" title="二分法"></a>二分法</h2><h2 id="不动点迭代"><a href="#不动点迭代" class="headerlink" title="不动点迭代"></a>不动点迭代</h2><h2 id="牛顿法"><a href="#牛顿法" class="headerlink" title="牛顿法"></a>牛顿法</h2><img src="https://s1.ax1x.com/2020/04/26/J6OiVO.png" alt="J6OiVO.png" border="0">

<h3 id="简化牛顿法"><a href="#简化牛顿法" class="headerlink" title="简化牛顿法"></a>简化牛顿法</h3><p><a href="https://imgchr.com/i/JQVzCD" target="_blank" rel="external nofollow noopener noreferrer"><img src="https://s1.ax1x.com/2020/04/20/JQVzCD.md.png" alt="JQVzCD.md.png" border="0"></a><br><a href="https://imgchr.com/i/JQVXE6" target="_blank" rel="external nofollow noopener noreferrer"><img src="https://s1.ax1x.com/2020/04/20/JQVXE6.md.png" alt="JQVXE6.md.png" border="0"></a><br><a href="https://imgchr.com/i/JQVv4O" target="_blank" rel="external nofollow noopener noreferrer"><img src="https://s1.ax1x.com/2020/04/20/JQVv4O.md.png" alt="JQVv4O.md.png" border="0"></a><br><a href="https://imgchr.com/i/JQVjUK" target="_blank" rel="external nofollow noopener noreferrer"><img src="https://s1.ax1x.com/2020/04/20/JQVjUK.md.png" alt="JQVjUK.md.png" border="0"></a><br><a href="https://imgchr.com/i/JQVLHx" target="_blank" rel="external nofollow noopener noreferrer"><img src="https://s1.ax1x.com/2020/04/20/JQVLHx.md.png" alt="JQVLHx.md.png" border="0"></a></p>
<h3 id="牛顿下山法"><a href="#牛顿下山法" class="headerlink" title="牛顿下山法"></a>牛顿下山法</h3><h3 id="重根情形"><a href="#重根情形" class="headerlink" title="重根情形"></a>重根情形</h3><h2 id="弦截法"><a href="#弦截法" class="headerlink" title="弦截法"></a>弦截法</h2><h3 id="单点弦截法"><a href="#单点弦截法" class="headerlink" title="单点弦截法"></a>单点弦截法</h3><h3 id="两点弦截法"><a href="#两点弦截法" class="headerlink" title="两点弦截法"></a>两点弦截法</h3><img src="https://s1.ax1x.com/2020/04/26/J6LDgI.png" alt="J6LDgI.png" border="0">

<p><a href="https://blog.csdn.net/qq_40991687/article/details/102004533" target="_blank" rel="external nofollow noopener noreferrer">https://blog.csdn.net/qq_40991687/article/details/102004533</a></p>
<hr>
<blockquote>
<p>能够摄取必要营养的人要比吃得很多的人更健康，同样地，真正的学者往往不是读了很多书的人，而是读了有用的书的人。</p>
</blockquote>

      
      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/%E6%95%B0%E5%80%BC%E5%88%86%E6%9E%90/">数值分析</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%89%9B%E9%A1%BF%E6%B3%95/" rel="tag">牛顿法</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-hadoop理论课-第五章Mapreduce" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/hadoop%E7%90%86%E8%AE%BA%E8%AF%BE-%E7%AC%AC%E4%BA%94%E7%AB%A0Mapreduce.html" class="article-date">
      <time datetime="2020-04-13T08:13:35.000Z" itemprop="datePublished">2020-04-13</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/hadoop%E7%90%86%E8%AE%BA%E8%AF%BE-%E7%AC%AC%E4%BA%94%E7%AB%A0Mapreduce.html">hadoop理论课-第五章Mapreduce</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <hr>
<script type="text/javascript" src="/js/src/bai.js"></script>

<h1 id="Mapreduce"><a href="#Mapreduce" class="headerlink" title="Mapreduce"></a>Mapreduce</h1><h2 id="MapReduce概述"><a href="#MapReduce概述" class="headerlink" title="MapReduce概述"></a>MapReduce概述</h2><h3 id="MapReduce是什么？"><a href="#MapReduce是什么？" class="headerlink" title="MapReduce是什么？"></a>MapReduce是什么？</h3><p><em>Mapreduce是一种简化并行计算的编程模型，用于进行大数据量的计算</em></p>
<p><a href="https://imgchr.com/i/GjRro8" target="_blank" rel="external nofollow noopener noreferrer"><img src="https://s1.ax1x.com/2020/04/13/GjRro8.md.png" alt="GjRro8.md.png" border="0"></a></p>
<h3 id="MapReduce设计思想"><a href="#MapReduce设计思想" class="headerlink" title="MapReduce设计思想"></a>MapReduce设计思想</h3><p><a href="https://imgchr.com/i/GjRDdf" target="_blank" rel="external nofollow noopener noreferrer"><img src="https://s1.ax1x.com/2020/04/13/GjRDdf.md.png" alt="GjRDdf.md.png" border="0"></a></p>
<h3 id="MapReduce特点"><a href="#MapReduce特点" class="headerlink" title="MapReduce特点"></a>MapReduce特点</h3><h4 id="易于编程"><a href="#易于编程" class="headerlink" title="易于编程"></a>易于编程</h4><h4 id="良好的扩展性"><a href="#良好的扩展性" class="headerlink" title="良好的扩展性"></a>良好的扩展性</h4><h4 id="高容错性"><a href="#高容错性" class="headerlink" title="高容错性"></a>高容错性</h4><h4 id="擅长对PB级以上海量数据进行离线处理"><a href="#擅长对PB级以上海量数据进行离线处理" class="headerlink" title="擅长对PB级以上海量数据进行离线处理"></a>擅长对PB级以上海量数据进行离线处理</h4><h3 id="MapReduce不擅长的场景"><a href="#MapReduce不擅长的场景" class="headerlink" title="MapReduce不擅长的场景"></a>MapReduce不擅长的场景</h3><h4 id="实时计算"><a href="#实时计算" class="headerlink" title="实时计算"></a>实时计算</h4><p><em>MapReduce无法像MySQL一样，在毫秒或秒级内返回结果</em></p>
<h4 id="流式计算"><a href="#流式计算" class="headerlink" title="流式计算"></a>流式计算</h4><p><em>流式计算的输入数据是动态的，而MapReduce的输入数据集是静态的，动态变化</em></p>
<h4 id="DAG-有向图-计算"><a href="#DAG-有向图-计算" class="headerlink" title="DAG(有向图)计算"></a>DAG(有向图)计算</h4><h2 id="MapReduce编程模型"><a href="#MapReduce编程模型" class="headerlink" title="MapReduce编程模型"></a>MapReduce编程模型</h2><h3 id="初识MapReduce模型"><a href="#初识MapReduce模型" class="headerlink" title="初识MapReduce模型"></a>初识MapReduce模型</h3><p><a href="https://imgchr.com/i/GjhcWD" target="_blank" rel="external nofollow noopener noreferrer"><img src="https://s1.ax1x.com/2020/04/13/GjhcWD.md.png" alt="GjhcWD.png" border="0"></a></p>
<p><a href="https://imgchr.com/i/GjhLlQ" target="_blank" rel="external nofollow noopener noreferrer"><img src="https://s1.ax1x.com/2020/04/13/GjhLlQ.md.png" alt="GjhLlQ.png" border="0"></a></p>
<p><a href="https://imgchr.com/i/Gj4f9U" target="_blank" rel="external nofollow noopener noreferrer"><img src="https://s1.ax1x.com/2020/04/13/Gj4f9U.md.png" alt="Gj4f9U.png" border="0"></a></p>
<p><em>MR原语:  相同的key为一组，调用一次reduce方法，迭代计算这一组数据</em></p>
<h3 id="MapReduce工作流程"><a href="#MapReduce工作流程" class="headerlink" title="MapReduce工作流程"></a>MapReduce工作流程</h3><p><a href="https://imgchr.com/i/Gj5Vgg" target="_blank" rel="external nofollow noopener noreferrer"><img src="https://s1.ax1x.com/2020/04/13/Gj5Vgg.md.png" alt="Gj5Vgg.png" border="0"></a></p>
<h3 id="MapReduce模型要点"><a href="#MapReduce模型要点" class="headerlink" title="MapReduce模型要点"></a>MapReduce模型要点</h3><p><a href="https://imgchr.com/i/Gj5cKH" target="_blank" rel="external nofollow noopener noreferrer"><img src="https://s1.ax1x.com/2020/04/13/Gj5cKH.md.png" alt="Gj5cKH.png" border="0"></a></p>
<h3 id="案例"><a href="#案例" class="headerlink" title="案例"></a>案例</h3><h4 id="案例一"><a href="#案例一" class="headerlink" title="案例一"></a>案例一</h4><p><a href="https://imgchr.com/i/Gj7nzT" target="_blank" rel="external nofollow noopener noreferrer"><img src="https://s1.ax1x.com/2020/04/13/Gj7nzT.md.png" alt="Gj7nzT.png" border="0"></a></p>
<p><a href="https://imgchr.com/i/Gj72Sf" target="_blank" rel="external nofollow noopener noreferrer"><img src="https://s1.ax1x.com/2020/04/13/Gj72Sf.md.png" alt="Gj72Sf.png" border="0"></a></p>
<p><a href="https://imgchr.com/i/GjHgE9" target="_blank" rel="external nofollow noopener noreferrer"><img src="https://s1.ax1x.com/2020/04/13/GjHgE9.md.png" alt="GjHgE9.png" border="0"></a></p>
<p><a href="https://imgchr.com/i/Gjq4mD" target="_blank" rel="external nofollow noopener noreferrer"><img src="https://s1.ax1x.com/2020/04/13/Gjq4mD.md.png" alt="Gjq4mD.png" border="0"></a></p>
<p><a href="https://imgchr.com/i/GjvqL6" target="_blank" rel="external nofollow noopener noreferrer"><img src="https://s1.ax1x.com/2020/04/13/GjvqL6.md.png" alt="GjvqL6.png" border="0"></a></p>
<p><a href="https://imgchr.com/i/GjxUp9" target="_blank" rel="external nofollow noopener noreferrer"><img src="https://s1.ax1x.com/2020/04/13/GjxUp9.md.png" alt="GjxUp9.png" border="0"></a></p>
<h4 id="案例二"><a href="#案例二" class="headerlink" title="案例二"></a>案例二</h4><p><a href="https://imgchr.com/i/Gjzi9J" target="_blank" rel="external nofollow noopener noreferrer"><img src="https://s1.ax1x.com/2020/04/13/Gjzi9J.png" alt="Gjzi9J.png" border="0"></a><br><a href="https://imgchr.com/i/GjzCh4" target="_blank" rel="external nofollow noopener noreferrer"><img src="https://s1.ax1x.com/2020/04/13/GjzCh4.md.png" alt="GjzCh4.md.png" border="0"></a></p>
<p><a href="https://imgchr.com/i/GvSbyn" target="_blank" rel="external nofollow noopener noreferrer"><img src="https://s1.ax1x.com/2020/04/13/GvSbyn.md.png" alt="GvSbyn.md.png" border="0"></a><br><a href="https://imgchr.com/i/GvSqLq" target="_blank" rel="external nofollow noopener noreferrer"><img src="https://s1.ax1x.com/2020/04/13/GvSqLq.md.png" alt="GvSqLq.md.png" border="0"></a></p>
<h4 id="案例三"><a href="#案例三" class="headerlink" title="案例三"></a>案例三</h4><p><em>序列化和反序列化</em></p>
<p><a href="https://imgchr.com/i/Gvpr7V" target="_blank" rel="external nofollow noopener noreferrer"><img src="https://s1.ax1x.com/2020/04/13/Gvpr7V.md.png" alt="Gvpr7V.md.png" border="0"></a><br><a href="https://imgchr.com/i/GvpykT" target="_blank" rel="external nofollow noopener noreferrer"><img src="https://s1.ax1x.com/2020/04/13/GvpykT.md.png" alt="GvpykT.md.png" border="0"></a></p>
<p><a href="https://imgchr.com/i/Gv9oKs" target="_blank" rel="external nofollow noopener noreferrer"><img src="https://s1.ax1x.com/2020/04/13/Gv9oKs.md.png" alt="Gv9oKs.md.png" border="0"></a><br><a href="https://imgchr.com/i/Gv9Trn" target="_blank" rel="external nofollow noopener noreferrer"><img src="https://s1.ax1x.com/2020/04/13/Gv9Trn.md.png" alt="Gv9Trn.md.png" border="0"></a></p>
<p><a href="https://imgchr.com/i/GvCtMj" target="_blank" rel="external nofollow noopener noreferrer"><img src="https://s1.ax1x.com/2020/04/13/GvCtMj.md.png" alt="GvCtMj.png" border="0"></a></p>
<h2 id="MapReduce进阶"><a href="#MapReduce进阶" class="headerlink" title="MapReduce进阶"></a>MapReduce进阶</h2><h3 id="mapreduce的输入格式"><a href="#mapreduce的输入格式" class="headerlink" title="mapreduce的输入格式"></a>mapreduce的输入格式</h3><h4 id="物理分片"><a href="#物理分片" class="headerlink" title="物理分片"></a>物理分片</h4><p><em>分割会严格按照设定大小128m或字数分割，可能会造成不符合逻辑的分割</em></p>
<h4 id="逻辑分片"><a href="#逻辑分片" class="headerlink" title="逻辑分片"></a>逻辑分片</h4><h5 id="inputFormat提供一下两个功能："><a href="#inputFormat提供一下两个功能：" class="headerlink" title="inputFormat提供一下两个功能："></a>inputFormat提供一下两个功能：</h5><ul>
<li>数据切分，获得SplitInput（逻辑切片） ，FileInputFormat.getSplits()获取到。</li>
<li>为Mapper提供输入数据</li>
</ul>
<p><em>有多少个SplitInput，就有多少个Mapper<br>TextInputFormat 是默认InputFormat</em></p>
<img src="https://s1.ax1x.com/2020/04/26/JgmCzn.png" alt="JgmCzn.png" border="0">

<p><em>getSplits 方法负责将一个大数据逻辑分成许多片，但每个分片只是一个逻辑上的定义，仅是提供了一个如何将数据分片的方法，并没有物理上的独立存储</em></p>
<p> <em>createRecordReader 方法返回一个 RecordReader 对象，实现了类似的迭代器功能，将某个InputSplit 解析成一个个 key/value 对</em></p>
<h5 id="定位记录边界"><a href="#定位记录边界" class="headerlink" title="定位记录边界"></a>定位记录边界</h5><p><em>为了能识别一条完整的记录，应该添加一些同步标示，如 TextInputFormat 的标示是换行符</em>  </p>
<h4 id="InputFormat-接口实现类"><a href="#InputFormat-接口实现类" class="headerlink" title="InputFormat 接口实现类"></a>InputFormat 接口实现类</h4><img src="https://s1.ax1x.com/2020/04/26/JgnVXt.png" alt="JgnVXt.png" border="0">

<h3 id="mapreduce的输出格式"><a href="#mapreduce的输出格式" class="headerlink" title="mapreduce的输出格式"></a>mapreduce的输出格式</h3><h4 id="outputFormat接口"><a href="#outputFormat接口" class="headerlink" title="outputFormat接口"></a>outputFormat接口</h4><p><em>OutputFormat主要用于描述输出数据的格式，通过RecordWriter能够将用户提供的key/value对写入特定格式的文件中</em></p>
<p>（1）TextOutputFormt调用toString()方法把它们转换为字符串<br>（2）NullWritable来省略输出的key或value</p>
<h4 id="outputFormat接口实现类"><a href="#outputFormat接口实现类" class="headerlink" title="outputFormat接口实现类"></a>outputFormat接口实现类</h4><img src="https://s1.ax1x.com/2020/04/26/JgnRAO.png" alt="JgnRAO.png" border="0">



<p><strong>排序</strong>：<em>排序是针对map输出里面的key，没会对value排序；map输出和reduce输入都有排序；作用是提高效率</em></p>
<h3 id="分区Partition"><a href="#分区Partition" class="headerlink" title="分区Partition"></a>分区Partition</h3><h4 id="Partition定义："><a href="#Partition定义：" class="headerlink" title="Partition定义："></a>Partition定义：</h4><p>Mapper任务划分数据的过程称作Partition。<br>负责实现数据的类称作Partitioner，默认的分区是Hash分区 (Hash Partition)</p>
<h4 id="Partition作用："><a href="#Partition作用：" class="headerlink" title="Partition作用："></a>Partition作用：</h4><p>将map阶段产生的所有&lt;key,value&gt;对分配给不同的Reducer 处理，可以将Reduce阶段的处理负载进行分摊</p>
<p><strong>Partition的数量决定Reducer的数量</strong></p>
<h4 id="Hash分区基本原理"><a href="#Hash分区基本原理" class="headerlink" title="Hash分区基本原理"></a>Hash分区基本原理</h4><p><em>计算某个值的hash值，如果结果相同，则放入同一个分区</em></p>
<p><em>Hash分区的作用：把数据打散进行存放，最终是为了避免热块</em></p>
<h4 id="合并Combiner"><a href="#合并Combiner" class="headerlink" title="合并Combiner"></a>合并Combiner</h4><p><em>减少Mapper输出到Reduce的数据量，缓解网络传输瓶颈，提高reducer的执行效率</em></p>
<p><em>需要注意的问题：一定要谨慎使用Combiner<br>有些情况不能使用Combiner —-&gt;  如：求平均值<br>保证引入Combiner以后，不能改变原来的逻辑</em></p>
<p><a href="https://imgchr.com/i/JfsWTI" target="_blank" rel="external nofollow noopener noreferrer"><img src="https://s1.ax1x.com/2020/04/27/JfsWTI.md.png" alt="JfsWTI.md.png" border="0"></a><br><a href="https://imgchr.com/i/JfsR0A" target="_blank" rel="external nofollow noopener noreferrer"><img src="https://s1.ax1x.com/2020/04/27/JfsR0A.md.png" alt="JfsR0A.md.png" border="0"></a></p>
<hr>
<blockquote>
<p>如果今天后悔昨天，那么明天就会后悔今天。</p>
</blockquote>

      
      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/Hadoop/">Hadoop</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Mapreduce/" rel="tag">Mapreduce</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
  
    <nav id="page-nav">
      <a class="extend prev" rel="prev" href="/page/13/">&amp;laquo; Prev</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/12/">12</a><a class="page-number" href="/page/13/">13</a><span class="page-number current">14</span><a class="page-number" href="/page/15/">15</a><a class="page-number" href="/page/16/">16</a><span class="space">&hellip;</span><a class="page-number" href="/page/20/">20</a><a class="extend next" rel="next" href="/page/15/">Next &amp;raquo;</a>
    </nav>
  
</div>
      <footer id="footer">
    <div class="outer">
        <div id="footer-info">
            <div class="footer-left">
                &copy; 2021 TTYONG
            </div>
            <div class="footer-right">
                <a href="http://hexo.io/" target="_blank" rel="external nofollow noopener noreferrer">Hexo</a>  Theme <a href="https://github.com/luuman/hexo-theme-spfk" target="_blank" rel="external nofollow noopener noreferrer">spfk</a> by luuman
            </div>
        </div>
        
            <div class="visit">
                
                    <span id="busuanzi_container_site_pv" style="display:none">
                        <span id="site-visit">海贼到访数: 
                            <span id="busuanzi_value_site_uv"></span>
                        </span>
                    </span>
                
                
                    <span>, </span>
                
                
                    <span id="busuanzi_container_page_pv" style="display:none">
                        <span id="page-visit">本页阅读量: 
                            <span id="busuanzi_value_page_pv"></span>
                        </span>
                    </span>
                
            </div>
        
    </div>
</footer>

    </div>
    
<script src="https://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>


<script src="/js/main.js"></script>


    <script>
        $(document).ready(function() {
            var backgroundnum = 24;
            var backgroundimg = "url(/background/bg-x.jpg)".replace(/x/gi, Math.ceil(Math.random() * backgroundnum));
            $("#mobile-nav").css({"background-image": backgroundimg,"background-size": "cover","background-position": "center"});
            $(".left-col").css({"background-image": backgroundimg,"background-size": "cover","background-position": "center"});
        })
    </script>





<div class="scroll" id="scroll">
    <a href="#"><i class="fa fa-arrow-up"></i></a>
    <a href="#comments"><i class="fa fa-comments-o"></i></a>
    <a href="#footer"><i class="fa fa-arrow-down"></i></a>
</div>
<script>
    $(document).ready(function() {
        if ($("#comments").length < 1) {
            $("#scroll > a:nth-child(2)").hide();
        };
    })
</script>

<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>

  <script language="javascript">
    $(function() {
        $("a[title]").each(function() {
            var a = $(this);
            var title = a.attr('title');
            if (title == undefined || title == "") return;
            a.data('title', title).removeAttr('title').hover(

            function() {
                var offset = a.offset();
                $("<div id=\"anchortitlecontainer\"></div>").appendTo($("body")).html(title).css({
                    top: offset.top - a.outerHeight() - 15,
                    left: offset.left + a.outerWidth()/2 + 1
                }).fadeIn(function() {
                    var pop = $(this);
                    setTimeout(function() {
                        pop.remove();
                    }, pop.text().length * 800);
                });
            }, function() {
                $("#anchortitlecontainer").remove();
            });
        });
    });
</script>


  </div>
<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"model":{"jsonPath":"live2d-widget-model-hibiki"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body>
